

--- FILE: ./main.tsx ---

import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.tsx'

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <App />
  </StrictMode>,
)


--- FILE: ./components/forms/AkunForm.tsx ---

import { useState } from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { registerSchema, type RegisterFormValues } from "@/utils/zodSchema";
import { akunService } from "@/services/akunService";

// Import UI Components
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from "@/components/ui/form";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { Spinner } from "@/components/ui/spinner";

// Import Icons
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faEnvelope, 
  faLock, 
  faUserPlus,
  faEye,
  faEyeSlash
} from "@fortawesome/free-solid-svg-icons";
import { toast } from "sonner";

interface AkunFormProps {
  onSuccess?: () => void;
}

export function AkunForm({ onSuccess }: AkunFormProps) {
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);
  const [isLoading, setIsLoading] = useState(false);
  const [successMessage, setSuccessMessage] = useState<string>("");
  const [errorMessage, setErrorMessage] = useState<string>("");

  const form = useForm<RegisterFormValues>({
    resolver: zodResolver(registerSchema),
    defaultValues: {
      email: "",
      username: "",
      password: "",
      confirmPassword: "",
    },
  });

  async function onSubmit(values: RegisterFormValues) {
    setIsLoading(true);
    setErrorMessage("");
    setSuccessMessage("");

    try {
      const response = await akunService.registerMuhafiz({
        email: values.email,
        username: values.username,
        password: values.password
      });

      if (response.success) {
        setSuccessMessage(`Akun muhafidz berhasil dibuat! Email: ${values.email}`);
        form.reset();
        if (onSuccess) onSuccess();
        toast.success("Akun muhafidz berhasil dibuat!");
      }
    } catch (error: any) {
      console.error("Register error:", error);
      const message = error.response?.data?.message || "Terjadi kesalahan saat membuat akun";
      setErrorMessage(message);
      toast.error(message);
      
      if (error.response?.status === 400 && message.includes("Email sudah terdaftar")) {
        form.setError("email", { type: "manual", message: "Email sudah terdaftar" });
        toast.error("Email sudah terdaftar");
      }
    } finally {
      setIsLoading(false);
    }
  }

  return (
    <div className="space-y-6">
      {/* Alert Messages */}
      {successMessage && (
        <Alert className="bg-green-50 border-green-200 text-green-800 dark:bg-green-900/20 dark:border-green-800 dark:text-green-300">
          <AlertDescription>{successMessage}</AlertDescription>
        </Alert>
      )}

      {errorMessage && (
        <Alert variant="destructive">
          <AlertDescription>{errorMessage}</AlertDescription>
        </Alert>
      )}

      <Form {...form}>
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-5 text-left">
          
          {/* Email Field */}
          <FormField
            control={form.control}
            name="email"
            render={({ field }) => (
              <FormItem className="space-y-2">
                <FormLabel>Email Address</FormLabel>
                <FormControl>
                  <div className="relative">
                    <span className="absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground">
                      <FontAwesomeIcon icon={faEnvelope} />
                    </span>
                    <Input
                      {...field}
                      type="email"
                      placeholder="muhafiz@example.com"
                      disabled={isLoading}
                      className="pl-10 h-11"
                    />
                  </div>
                </FormControl>
                <FormMessage />
              </FormItem>
            )}
          />

          {/* Username Field */}
          <FormField
            control={form.control}
            name="username"
            render={({ field }) => (
              <FormItem className="space-y-2">
                <FormLabel>Username</FormLabel>
                <FormControl>
                  <Input
                    {...field}
                    placeholder="Username"
                    disabled={isLoading}
                    className="h-11"
                  />
                </FormControl>
                <FormMessage />
              </FormItem>
            )}
          />

          {/* Password Field */}
          <FormField
            control={form.control}
            name="password"
            render={({ field }) => (
              <FormItem className="space-y-2">
                <FormLabel>Password</FormLabel>
                <FormControl>
                  <div className="relative">
                    <span className="absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground">
                      <FontAwesomeIcon icon={faLock} />
                    </span>
                    <Input
                      {...field}
                      type={showPassword ? "text" : "password"}
                      placeholder="Minimal 8 karakter"
                      disabled={isLoading}
                      className="pl-10 pr-10 h-11"
                    />
                    {/* Shadcn Button sebagai toggle password */}
                    <Button
                      type="button"
                      variant="ghost"
                      size="sm"
                      className="absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 px-0 hover:bg-transparent text-muted-foreground hover:text-primary"
                      onClick={() => setShowPassword(!showPassword)}
                    >
                      <FontAwesomeIcon icon={showPassword ? faEyeSlash : faEye} />
                    </Button>
                  </div>
                </FormControl>
                <FormMessage />
              </FormItem>
            )}
          />

          {/* Confirm Password Field */}
          <FormField
            control={form.control}
            name="confirmPassword"
            render={({ field }) => (
              <FormItem className="space-y-2">
                <FormLabel>Konfirmasi Password</FormLabel>
                <FormControl>
                  <div className="relative">
                    <span className="absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground">
                      <FontAwesomeIcon icon={faLock} />
                    </span>
                    <Input
                      {...field}
                      type={showConfirmPassword ? "text" : "password"}
                      placeholder="Ulangi password"
                      disabled={isLoading}
                      className="pl-10 pr-10 h-11"
                    />
                    {/* Shadcn Button sebagai toggle password */}
                    <Button
                      type="button"
                      variant="ghost"
                      size="sm"
                      className="absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 px-0 hover:bg-transparent text-muted-foreground hover:text-primary"
                      onClick={() => setShowConfirmPassword(!showConfirmPassword)}
                    >
                      <FontAwesomeIcon icon={showConfirmPassword ? faEyeSlash : faEye} />
                    </Button>
                  </div>
                </FormControl>
                <FormMessage />
              </FormItem>
            )}
          />

          {/* Submit Button Utama */}
          <Button
            type="submit"
            disabled={isLoading}
            className="w-full h-11 mt-4"
          >
            {isLoading ? (
              <>
                <Spinner className="mr-2 h-4 w-4" />
                Membuat Akun...
              </>
            ) : (
              <>
                <FontAwesomeIcon icon={faUserPlus} className="mr-2" />
                Buat Akun Muhafidz
              </>
            )}
          </Button>

          <div className="pt-4 border-t">
            <p className="text-xs text-muted-foreground text-center">
              Akun yang dibuat akan langsung aktif dan dapat digunakan untuk login.
            </p>
          </div>
        </form>
      </Form>
    </div>
  );
}

--- FILE: ./components/forms/LoginForm.tsx ---

import { useState } from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { useNavigate } from "react-router-dom";
import { loginSchema, type LoginFormValues } from "@/utils/zodSchema";
import { useAuth } from "@/context/AuthContext";

// Import Shadcn UI
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from "@/components/ui/form";

// Import FontAwesome
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faEnvelope, 
  faLock, 
  faArrowRight, 
  faEye, 
  faEyeSlash 
} from "@fortawesome/free-solid-svg-icons";

export function LoginForm() {
  const [showPassword, setShowPassword] = useState(false);
  const { login, isLoading } = useAuth();
  const navigate = useNavigate();

  const form = useForm<LoginFormValues>({
    resolver: zodResolver(loginSchema),
    defaultValues: {
      email: "",
      password: "",
    },
  });

async function onSubmit(values: LoginFormValues) {
  try {
    await login(values);
    navigate("/");
  } catch (error: any) {
    // Tangkap pesan error dari backend
    console.error("Full Error Object:", error);
    console.log("Status Code:", error.response?.status);
    console.log("Response Data:", error.response?.data);
    const message = error.response?.data?.message || "Terjadi kesalahan koneksi";
    
    // Set error ke field password agar muncul di FormMessage
    form.setError("password", { 
      type: "manual", 
      message: message 
    });
  }
}

  return (
    <Form {...form}>
      <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-5">
        
        {/* Email Field */}
        <FormField
          control={form.control}
          name="email"
          render={({ field }) => (
            <FormItem className="space-y-2">
              <FormLabel className="text-sm font-medium dark:text-white">
                Email Address
              </FormLabel>
              <FormControl>
                <div className="relative">
                  <span className="absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary-light dark:text-gray-400">
                    <FontAwesomeIcon icon={faEnvelope} className="text-[18px]" />
                  </span>
                  <Input
                    {...field}
                    type="email"
                    placeholder="ustadz@example.com"
                    disabled={isLoading}
                    className="h-12 pl-10 border-[#d6e7d0] dark:border-gray-600 bg-background-light dark:bg-surface-dark focus:ring-2 focus:ring-primary transition-all"
                  />
                </div>
              </FormControl>
              <FormMessage className="text-xs" />
            </FormItem>
          )}
        />

        {/* Password Field */}
        <FormField
          control={form.control}
          name="password"
          render={({ field }) => (
            <FormItem className="space-y-2">
              <div className="flex items-center justify-between">
                <FormLabel className="text-sm font-medium dark:text-white">
                  Password
                </FormLabel>
                <a
                  href="#"
                  className="text-xs font-medium text-primary hover:text-primary-dark hover:underline"
                >
                  Forgot Password?
                </a>
              </div>
              <FormControl>
                <div className="relative">
                  <span className="absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary-light dark:text-gray-400">
                    <FontAwesomeIcon icon={faLock} className="text-[18px]" />
                  </span>
                  <Input
                    {...field}
                    type={showPassword ? "text" : "password"}
                    placeholder="Masukkan password"
                    disabled={isLoading}
                    className="h-12 pl-10 pr-10 border-[#d6e7d0] dark:border-gray-600 bg-background-light dark:bg-surface-dark focus:ring-2 focus:ring-primary transition-all"
                  />
                  <button
                    type="button"
                    onClick={() => setShowPassword(!showPassword)}
                    className="absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary-light hover:text-primary transition-colors"
                  >
                    <FontAwesomeIcon icon={showPassword ? faEyeSlash : faEye} className="text-[18px]" />
                  </button>
                </div>
              </FormControl>
              <FormMessage className="text-xs" />
            </FormItem>
          )}
        />

        {/* Submit Button */}
        <Button
          type="submit"
          disabled={isLoading}
          className="w-full h-12 bg-primary hover:bg-primary-dark text-white font-semibold shadow-lg shadow-primary/20"
        >
          {isLoading ? (
            <span className="flex items-center gap-2">
              <svg className="animate-spin h-4 w-4 text-white" viewBox="0 0 24 24">
                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" fill="none" />
                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
              </svg>
              Mohon tunggu...
            </span>
          ) : (
            <span className="flex items-center gap-2">
              Sign In
              <FontAwesomeIcon icon={faArrowRight} className="text-sm" />
            </span>
          )}
        </Button>
      </form>
    </Form>
  );
}

--- FILE: ./components/forms/HalaqahForm.tsx ---

import { useState, useEffect } from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import { halaqahService, type CreateHalaqahData } from "@/services/halaqahService";

import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from "@/components/ui/form";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { Spinner } from "@/components/ui/spinner";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { toast } from "sonner";

// Import Icons
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faBook, faPlus, faCheck, faExclamationTriangle } from "@fortawesome/free-solid-svg-icons";

const halaqahSchema = z.object({
  nama_halaqah: z.string().min(3, "Nama halaqah minimal 3 karakter"),
  jenis: z.enum(["BACAAN", "HAFALAN", "KHUSUS"]),
  muhafidz_id: z.number().min(1, "Pilih muhafidz"),
});

type HalaqahFormValues = z.infer<typeof halaqahSchema>;

interface HalaqahFormProps {
  onSuccess?: () => void;
  initialData?: {
    id_halaqah?: number;
    nama_halaqah?: string;
    jenis?: "BACAAN" | "HAFALAN" | "KHUSUS";
    muhafidz_id?: number;
  };
}

export function HalaqahForm({ onSuccess, initialData }: HalaqahFormProps) {
  const [isLoading, setIsLoading] = useState(false);
  const [loadingMuhafiz, setLoadingMuhafiz] = useState(false);
  const [errorMessage, setErrorMessage] = useState<string>("");
  const [availableMuhafiz, setAvailableMuhafiz] = useState<Array<{ id_user: number; username: string; email: string }>>([]);

  const form = useForm<HalaqahFormValues>({
    resolver: zodResolver(halaqahSchema),
    defaultValues: {
      nama_halaqah: initialData?.nama_halaqah || "",
      jenis: initialData?.jenis || "HAFALAN",
      muhafidz_id: initialData?.muhafidz_id || 0,
    },
  });

  useEffect(() => {
    loadAvailableMuhafiz();
  }, []);

  const loadAvailableMuhafiz = async () => {
    setLoadingMuhafiz(true);
    try {
      const response = await halaqahService.getAvailableMuhafiz();
      setAvailableMuhafiz(response.data);
    } catch (error) {
      console.error("Error loading muhafiz:", error);
      toast.error("Gagal memuat daftar muhafidz");
    } finally {
      setLoadingMuhafiz(false);
    }
  };

  async function onSubmit(values: HalaqahFormValues) {
    setIsLoading(true);
    setErrorMessage("");

    try {
      const data: CreateHalaqahData = {
        nama_halaqah: values.nama_halaqah,
        jenis: values.jenis,
        muhafidz_id: values.muhafidz_id,
      };

      if (initialData?.id_halaqah) {
        await halaqahService.updateHalaqah(initialData.id_halaqah, data);
        toast.success("Halaqah berhasil diperbarui");
      } else {
        await halaqahService.createHalaqah(data);
        toast.success("Halaqah baru berhasil dibuat");
      }

      form.reset();
      if (onSuccess) onSuccess(); // Langsung tutup modal/refresh table
    } catch (error: any) {
      const message = error.response?.data?.message || "Terjadi kesalahan saat menyimpan data";
      setErrorMessage(message); // Alert tetap digunakan untuk error agar user bisa baca detailnya
    } finally {
      setIsLoading(false);
    }
  }

  return (
    <div className="space-y-6 text-left">
      {availableMuhafiz.length === 0 && !loadingMuhafiz && (
        <Alert variant="destructive" className="bg-destructive/5 border-destructive/20 text-destructive">
          <FontAwesomeIcon icon={faExclamationTriangle} className="h-4 w-4" />
          <AlertTitle>Muhafidz Tidak Tersedia</AlertTitle>
          <AlertDescription className="text-xs">
            Semua muhafidz sudah memiliki halaqah. Silahkan buat akun muhafidz baru terlebih dahulu sebelum membuat halaqah.
          </AlertDescription>
        </Alert>
      )}

      {errorMessage && (
        <Alert variant="destructive">
          <AlertDescription>{errorMessage}</AlertDescription>
        </Alert>
      )}

      <Form {...form}>
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-5">
          
          <FormField
            control={form.control}
            name="nama_halaqah"
            render={({ field }) => (
              <FormItem className="space-y-2">
                <FormLabel>Nama Halaqah</FormLabel>
                <FormControl>
                  <div className="relative">
                    <span className="absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground">
                      <FontAwesomeIcon icon={faBook} />
                    </span>
                    <Input
                      {...field}
                      placeholder="Contoh: Halaqah Abu Bakar"
                      disabled={isLoading}
                      className="pl-10 h-11"
                    />
                  </div>
                </FormControl>
                <FormMessage />
              </FormItem>
            )}
          />

          <FormField
            control={form.control}
            name="jenis"
            render={({ field }) => (
              <FormItem className="space-y-2">
                <FormLabel>Jenis Halaqah</FormLabel>
                <Select onValueChange={field.onChange} defaultValue={field.value}>
                  <FormControl>
                    <SelectTrigger className="h-11">
                      <SelectValue placeholder="Pilih jenis" />
                    </SelectTrigger>
                  </FormControl>
                  <SelectContent>
                    <SelectItem value="BACAAN">Bacaan</SelectItem>
                    <SelectItem value="HAFALAN">Hafalan</SelectItem>
                    <SelectItem value="KHUSUS">Khusus</SelectItem>
                  </SelectContent>
                </Select>
                <FormMessage />
              </FormItem>
            )}
          />

          <FormField
            control={form.control}
            name="muhafidz_id"
            render={({ field }) => (
              <FormItem className="space-y-2">
                <FormLabel>Muhafidz</FormLabel>
                <Select 
                  onValueChange={(value) => field.onChange(parseInt(value))} 
                  defaultValue={field.value ? field.value.toString() : undefined}
                >
                  <FormControl>
                    <SelectTrigger className="h-11" disabled={loadingMuhafiz || availableMuhafiz.length === 0}>
                      {loadingMuhafiz ? (
                        <span className="flex items-center gap-2">
                          <Spinner className="h-4 w-4" /> Memuat...
                        </span>
                      ) : (
                        <SelectValue placeholder="Pilih muhafidz" />
                      )}
                    </SelectTrigger>
                  </FormControl>
                  <SelectContent>
                    {availableMuhafiz.map((muhafiz) => (
                      <SelectItem key={muhafiz.id_user} value={muhafiz.id_user.toString()}>
                        {muhafiz.username}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
                <FormMessage />
              </FormItem>
            )}
          />

          <Button
            type="submit"
            disabled={isLoading || loadingMuhafiz || availableMuhafiz.length === 0}
            className="w-full h-11 mt-2"
          >
            {isLoading ? (
              <><Spinner className="mr-2 h-4 w-4" /> Menyimpan...</>
            ) : (
              <><FontAwesomeIcon icon={initialData?.id_halaqah ? faCheck : faPlus} className="mr-2" /> 
                {initialData?.id_halaqah ? "Simpan Perubahan" : "Buat Halaqah Baru"}
              </>
            )}
          </Button>
        </form>
      </Form>
    </div>
  );
}

--- FILE: ./components/ui/button.tsx ---

import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
        "icon-sm": "size-8",
        "icon-lg": "size-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant = "default",
  size = "default",
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      data-variant={variant}
      data-size={size}
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }


--- FILE: ./components/ui/form.tsx ---

"use client"

import * as React from "react"
import type * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  FormProvider,
  useFormContext,
  useFormState,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
} from "react-hook-form"

import { cn } from "@/lib/utils"
import { Label } from "@/components/ui/label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState } = useFormContext()
  const formState = useFormState({ name: fieldContext.name })
  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

function FormItem({ className, ...props }: React.ComponentProps<"div">) {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div
        data-slot="form-item"
        className={cn("grid gap-2", className)}
        {...props}
      />
    </FormItemContext.Provider>
  )
}

function FormLabel({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  const { error, formItemId } = useFormField()

  return (
    <Label
      data-slot="form-label"
      data-error={!!error}
      className={cn("data-[error=true]:text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
}

function FormControl({ ...props }: React.ComponentProps<typeof Slot>) {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      data-slot="form-control"
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
}

function FormDescription({ className, ...props }: React.ComponentProps<"p">) {
  const { formDescriptionId } = useFormField()

  return (
    <p
      data-slot="form-description"
      id={formDescriptionId}
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function FormMessage({ className, ...props }: React.ComponentProps<"p">) {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message ?? "") : props.children

  if (!body) {
    return null
  }

  return (
    <p
      data-slot="form-message"
      id={formMessageId}
      className={cn("text-destructive text-sm", className)}
      {...props}
    >
      {body}
    </p>
  )
}

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}


--- FILE: ./components/ui/label.tsx ---

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"

import { cn } from "@/lib/utils"

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Label }


--- FILE: ./components/ui/alert.tsx ---

import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",
  {
    variants: {
      variant: {
        default: "bg-card text-card-foreground",
        destructive:
          "text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Alert({
  className,
  variant,
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof alertVariants>) {
  return (
    <div
      data-slot="alert"
      role="alert"
      className={cn(alertVariants({ variant }), className)}
      {...props}
    />
  )
}

function AlertTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-title"
      className={cn(
        "col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",
        className
      )}
      {...props}
    />
  )
}

function AlertDescription({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-description"
      className={cn(
        "text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",
        className
      )}
      {...props}
    />
  )
}

export { Alert, AlertTitle, AlertDescription }


--- FILE: ./components/ui/avatar.tsx ---

import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

function Avatar({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        "relative flex size-8 shrink-0 overflow-hidden rounded-full",
        className
      )}
      {...props}
    />
  )
}

function AvatarImage({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
  return (
    <AvatarPrimitive.Image
      data-slot="avatar-image"
      className={cn("aspect-square size-full", className)}
      {...props}
    />
  )
}

function AvatarFallback({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
  return (
    <AvatarPrimitive.Fallback
      data-slot="avatar-fallback"
      className={cn(
        "bg-muted flex size-full items-center justify-center rounded-full",
        className
      )}
      {...props}
    />
  )
}

export { Avatar, AvatarImage, AvatarFallback }


--- FILE: ./components/ui/badge.tsx ---

import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
        destructive:
          "border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Badge({
  className,
  variant,
  asChild = false,
  ...props
}: React.ComponentProps<"span"> &
  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "span"

  return (
    <Comp
      data-slot="badge"
      className={cn(badgeVariants({ variant }), className)}
      {...props}
    />
  )
}

export { Badge, badgeVariants }


--- FILE: ./components/ui/card.tsx ---

import * as React from "react"

import { cn } from "@/lib/utils"

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
        className
      )}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("leading-none font-semibold", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}


--- FILE: ./components/ui/dialog.tsx ---

import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Dialog({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Root>) {
  return <DialogPrimitive.Root data-slot="dialog" {...props} />
}

function DialogTrigger({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {
  return <DialogPrimitive.Trigger data-slot="dialog-trigger" {...props} />
}

function DialogPortal({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Portal>) {
  return <DialogPrimitive.Portal data-slot="dialog-portal" {...props} />
}

function DialogClose({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Close>) {
  return <DialogPrimitive.Close data-slot="dialog-close" {...props} />
}

function DialogOverlay({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {
  return (
    <DialogPrimitive.Overlay
      data-slot="dialog-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function DialogContent({
  className,
  children,
  showCloseButton = true,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Content> & {
  showCloseButton?: boolean
}) {
  return (
    <DialogPortal data-slot="dialog-portal">
      <DialogOverlay />
      <DialogPrimitive.Content
        data-slot="dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",
          className
        )}
        {...props}
      >
        {children}
        {showCloseButton && (
          <DialogPrimitive.Close
            data-slot="dialog-close"
            className="ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4"
          >
            <XIcon />
            <span className="sr-only">Close</span>
          </DialogPrimitive.Close>
        )}
      </DialogPrimitive.Content>
    </DialogPortal>
  )
}

function DialogHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  )
}

function DialogFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    />
  )
}

function DialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Title>) {
  return (
    <DialogPrimitive.Title
      data-slot="dialog-title"
      className={cn("text-lg leading-none font-semibold", className)}
      {...props}
    />
  )
}

function DialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Description>) {
  return (
    <DialogPrimitive.Description
      data-slot="dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Dialog,
  DialogClose,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogOverlay,
  DialogPortal,
  DialogTitle,
  DialogTrigger,
}


--- FILE: ./components/ui/select.tsx ---

import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { CheckIcon, ChevronDownIcon, ChevronUpIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Select({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Root>) {
  return <SelectPrimitive.Root data-slot="select" {...props} />
}

function SelectGroup({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Group>) {
  return <SelectPrimitive.Group data-slot="select-group" {...props} />
}

function SelectValue({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Value>) {
  return <SelectPrimitive.Value data-slot="select-value" {...props} />
}

function SelectTrigger({
  className,
  size = "default",
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
  size?: "sm" | "default"
}) {
  return (
    <SelectPrimitive.Trigger
      data-slot="select-trigger"
      data-size={size}
      className={cn(
        "border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <SelectPrimitive.Icon asChild>
        <ChevronDownIcon className="size-4 opacity-50" />
      </SelectPrimitive.Icon>
    </SelectPrimitive.Trigger>
  )
}

function SelectContent({
  className,
  children,
  position = "item-aligned",
  align = "center",
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
  return (
    <SelectPrimitive.Portal>
      <SelectPrimitive.Content
        data-slot="select-content"
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",
          position === "popper" &&
            "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
          className
        )}
        position={position}
        align={align}
        {...props}
      >
        <SelectScrollUpButton />
        <SelectPrimitive.Viewport
          className={cn(
            "p-1",
            position === "popper" &&
              "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"
          )}
        >
          {children}
        </SelectPrimitive.Viewport>
        <SelectScrollDownButton />
      </SelectPrimitive.Content>
    </SelectPrimitive.Portal>
  )
}

function SelectLabel({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Label>) {
  return (
    <SelectPrimitive.Label
      data-slot="select-label"
      className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
      {...props}
    />
  )
}

function SelectItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Item>) {
  return (
    <SelectPrimitive.Item
      data-slot="select-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
        className
      )}
      {...props}
    >
      <span
        data-slot="select-item-indicator"
        className="absolute right-2 flex size-3.5 items-center justify-center"
      >
        <SelectPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </SelectPrimitive.ItemIndicator>
      </span>
      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
    </SelectPrimitive.Item>
  )
}

function SelectSeparator({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Separator>) {
  return (
    <SelectPrimitive.Separator
      data-slot="select-separator"
      className={cn("bg-border pointer-events-none -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function SelectScrollUpButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
  return (
    <SelectPrimitive.ScrollUpButton
      data-slot="select-scroll-up-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronUpIcon className="size-4" />
    </SelectPrimitive.ScrollUpButton>
  )
}

function SelectScrollDownButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
  return (
    <SelectPrimitive.ScrollDownButton
      data-slot="select-scroll-down-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronDownIcon className="size-4" />
    </SelectPrimitive.ScrollDownButton>
  )
}

export {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectLabel,
  SelectScrollDownButton,
  SelectScrollUpButton,
  SelectSeparator,
  SelectTrigger,
  SelectValue,
}


--- FILE: ./components/ui/skeleton.tsx ---

import { cn } from "@/lib/utils"

function Skeleton({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="skeleton"
      className={cn("bg-accent animate-pulse rounded-md", className)}
      {...props}
    />
  )
}

export { Skeleton }


--- FILE: ./components/ui/spinner.tsx ---

import { Loader2Icon } from "lucide-react"

import { cn } from "@/lib/utils"

function Spinner({ className, ...props }: React.ComponentProps<"svg">) {
  return (
    <Loader2Icon
      role="status"
      aria-label="Loading"
      className={cn("size-4 animate-spin", className)}
      {...props}
    />
  )
}

export { Spinner }


--- FILE: ./components/ui/table.tsx ---

import * as React from "react"

import { cn } from "@/lib/utils"

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div
      data-slot="table-container"
      className="relative w-full overflow-x-auto"
    >
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  )
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  )
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  )
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn(
        "bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
        className
      )}
      {...props}
    />
  )
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn(
        "hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
        className
      )}
      {...props}
    />
  )
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn(
        "text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn(
        "p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  )
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}


--- FILE: ./components/ui/tabs.tsx ---

import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

function Tabs({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Root>) {
  return (
    <TabsPrimitive.Root
      data-slot="tabs"
      className={cn("flex flex-col gap-2", className)}
      {...props}
    />
  )
}

function TabsList({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.List>) {
  return (
    <TabsPrimitive.List
      data-slot="tabs-list"
      className={cn(
        "bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",
        className
      )}
      {...props}
    />
  )
}

function TabsTrigger({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {
  return (
    <TabsPrimitive.Trigger
      data-slot="tabs-trigger"
      className={cn(
        "data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function TabsContent({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Content>) {
  return (
    <TabsPrimitive.Content
      data-slot="tabs-content"
      className={cn("flex-1 outline-none", className)}
      {...props}
    />
  )
}

export { Tabs, TabsList, TabsTrigger, TabsContent }


--- FILE: ./components/ui/toast.tsx ---



--- FILE: ./components/ui/dropdown-menu.tsx ---

import * as React from "react"
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function DropdownMenu({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
  return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />
}

function DropdownMenuPortal({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
  return (
    <DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
  )
}

function DropdownMenuTrigger({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
  return (
    <DropdownMenuPrimitive.Trigger
      data-slot="dropdown-menu-trigger"
      {...props}
    />
  )
}

function DropdownMenuContent({
  className,
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
  return (
    <DropdownMenuPrimitive.Portal>
      <DropdownMenuPrimitive.Content
        data-slot="dropdown-menu-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",
          className
        )}
        {...props}
      />
    </DropdownMenuPrimitive.Portal>
  )
}

function DropdownMenuGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
  return (
    <DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
  )
}

function DropdownMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
  inset?: boolean
  variant?: "default" | "destructive"
}) {
  return (
    <DropdownMenuPrimitive.Item
      data-slot="dropdown-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
  return (
    <DropdownMenuPrimitive.CheckboxItem
      data-slot="dropdown-menu-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.CheckboxItem>
  )
}

function DropdownMenuRadioGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
  return (
    <DropdownMenuPrimitive.RadioGroup
      data-slot="dropdown-menu-radio-group"
      {...props}
    />
  )
}

function DropdownMenuRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
  return (
    <DropdownMenuPrimitive.RadioItem
      data-slot="dropdown-menu-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.RadioItem>
  )
}

function DropdownMenuLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.Label
      data-slot="dropdown-menu-label"
      data-inset={inset}
      className={cn(
        "px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSeparator({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
  return (
    <DropdownMenuPrimitive.Separator
      data-slot="dropdown-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function DropdownMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="dropdown-menu-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSub({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
  return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />
}

function DropdownMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.SubTrigger
      data-slot="dropdown-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto size-4" />
    </DropdownMenuPrimitive.SubTrigger>
  )
}

function DropdownMenuSubContent({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
  return (
    <DropdownMenuPrimitive.SubContent
      data-slot="dropdown-menu-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className
      )}
      {...props}
    />
  )
}

export {
  DropdownMenu,
  DropdownMenuPortal,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuLabel,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioGroup,
  DropdownMenuRadioItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
}


--- FILE: ./components/ui/input.tsx ---

import * as React from "react"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        `
        h-9 w-full min-w-0 rounded-md border
        bg-[var(--input)]
        text-[var(--foreground)]
        border-[var(--border)]
        px-3 py-1 text-base shadow-xs
        transition-[color,box-shadow]
        outline-none

        placeholder:text-[var(--muted)]
        selection:bg-primary
        selection:text-primary-foreground

        focus-visible:border-ring
        focus-visible:ring-ring/50
        focus-visible:ring-[3px]

        disabled:pointer-events-none
        disabled:cursor-not-allowed
        disabled:opacity-50

        file:inline-flex
        file:h-7
        file:border-0
        file:bg-transparent
        file:text-sm
        file:font-medium
        `,
        className
      )}
      {...props}
    />
  )
}

export { Input }


--- FILE: ./components/ui/sonner.tsx ---

import {
  CircleCheckIcon,
  InfoIcon,
  Loader2Icon,
  OctagonXIcon,
  TriangleAlertIcon,
} from "lucide-react"
import { useTheme } from "next-themes"
import { Toaster as Sonner, type ToasterProps } from "sonner"

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme()

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      icons={{
        success: <CircleCheckIcon className="size-4" />,
        info: <InfoIcon className="size-4" />,
        warning: <TriangleAlertIcon className="size-4" />,
        error: <OctagonXIcon className="size-4" />,
        loading: <Loader2Icon className="size-4 animate-spin" />,
      }}
      style={
        {
          "--normal-bg": "var(--popover)",
          "--normal-text": "var(--popover-foreground)",
          "--normal-border": "var(--border)",
          "--border-radius": "var(--radius)",
        } as React.CSSProperties
      }
      {...props}
    />
  )
}

export { Toaster }


--- FILE: ./components/ThemeToggle.tsx ---

import { useAuth } from "@/context/AuthContext";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faSun, faMoon } from "@fortawesome/free-solid-svg-icons";

// 1. Tambahkan interface untuk mendefinisikan props
interface ThemeToggleProps {
  variant?: "simple" | "default"; // "?" berarti opsional
}

// 2. Terima props di fungsi
export function ThemeToggle({ variant = "default" }: ThemeToggleProps) {
  const { isDarkMode, toggleDarkMode } = useAuth();

  // 3. Logika untuk varian "simple"
  if (variant === "simple") {
    return (
      <button onClick={toggleDarkMode} className="p-2">
        <FontAwesomeIcon 
          icon={isDarkMode ? faSun : faMoon} 
          className={isDarkMode ? 'text-yellow-500' : 'text-gray-500'}
        />
      </button>
    );
  }

  // Tampilan default (kode asli kamu)
  return (
    <button
      onClick={toggleDarkMode}
      type="button"
      className="relative inline-flex items-center justify-center w-12 h-6 rounded-full transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 bg-gray-200 dark:bg-gray-700"
      aria-label={`Switch to ${isDarkMode ? 'light' : 'dark'} mode`}
    >
      <div className="absolute inset-0 rounded-full bg-gradient-to-r from-blue-100 to-yellow-100 dark:from-gray-800 dark:to-purple-800 opacity-60" />
      
      <div
        className={`absolute left-1 top-1 w-4 h-4 rounded-full bg-white shadow-lg transform transition-transform duration-300 ${
          isDarkMode ? 'translate-x-6' : 'translate-x-0'
        }`}
      >
        <div className="flex items-center justify-center h-full">
          <FontAwesomeIcon 
            icon={isDarkMode ? faSun : faMoon} 
            className={`text-[10px] ${
              isDarkMode ? 'text-yellow-500' : 'text-indigo-600'
            }`}
          />
        </div>
      </div>
      
      <div className="flex items-center justify-between w-full px-1.5">
        <FontAwesomeIcon icon={faSun} className="text-[10px] text-yellow-500 opacity-80" />
        <FontAwesomeIcon icon={faMoon} className="text-[10px] text-indigo-400 opacity-80" />
      </div>
    </button>
  );
}

--- FILE: ./components/shared/Sidebar.tsx ---

import { useAuth } from "@/context/AuthContext";
import { Link, useLocation } from "react-router-dom";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faChartPie, 
  faUsers, 
  faBook, 
  faClipboardCheck, 
  faUserTie,
  faSignOutAlt,
  faBookOpen,
  faTimes
} from "@fortawesome/free-solid-svg-icons";
import { cn } from "@/lib/utils";

export function Sidebar({ onClose }: { onClose?: () => void }) {
  const { user, logout } = useAuth();
  const location = useLocation();

  // Definisi Menu berdasarkan Role (Sesuai Flowchart)
  const menuItems = user?.role === "superadmin" 
    ? [
        { name: "Dashboard", path: "/kepala-muhafidz", icon: faChartPie },
        { name: "Kelola Muhafiz", path: "/kepala-muhafidz/muhafiz", icon: faUserTie },
        { name: "Kelola Halaqah", path: "/kepala-muhafidz/halaqah", icon: faBook },
        { name: "Lihat Laporan", path: "/kepala-muhafidz/laporan", icon: faClipboardCheck },
      ]
    : [
        { name: "Absensi Hari Ini", path: "/muhafidz", icon: faClipboardCheck },
        { name: "Input Setoran", path: "/muhafidz/setoran", icon: faBookOpen },
        { name: "Kelola Santri", path: "/muhafidz/santri", icon: faUsers },
        { name: "Progres Santri", path: "/muhafidz/progres", icon: faChartPie },
      ];

  return (
    <aside className="flex h-screen w-64 flex-col border-r border-border bg-surface-light dark:bg-surface-dark transition-colors duration-300">
      {/* Logo Section */}
      <div className="flex h-20 items-center justify-between px-6"> 
        <div className="flex items-center gap-3">
          <div className="flex h-9 w-9 items-center justify-center rounded-lg bg-primary text-white shadow-lg shadow-primary/20">
            <FontAwesomeIcon icon={faBookOpen} />
          </div>
          <span className="text-xl font-bold tracking-tight dark:text-white font-display">HalaqahId</span>
        </div>
        
        {/* Tombol Close - Hanya muncul di mobile */}
        <button onClick={onClose} className="lg:hidden text-text-secondary dark:text-white">
          <FontAwesomeIcon icon={faTimes} />
        </button>
      </div>

      {/* Navigation */}
      <nav className="flex-1 space-y-1 px-3 py-4">
        {menuItems.map((item) => {
          const isActive = location.pathname === item.path;
          return (
            <Link
              key={item.name}
              to={item.path}
              onClick={onClose} // Tutup sidebar setelah klik link di mobile
              className={cn(
                "flex items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium transition-all duration-200",
                isActive 
                  ? "bg-primary/10 text-primary dark:bg-primary/20" 
                  : "text-text-secondary hover:bg-accent/50 dark:text-text-secondary-dark dark:hover:bg-accent/10"
              )}
            >
              <FontAwesomeIcon icon={item.icon} className={cn("w-5", isActive ? "text-primary" : "opacity-70")} />
              {item.name}
            </Link>
          );
        })}
      </nav>

      {/* Logout Button */}
      <div className="border-t border-border p-4">
        <button
          onClick={logout}
          className="flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium text-destructive hover:bg-destructive/10 transition-colors"
        >
          <FontAwesomeIcon icon={faSignOutAlt} />
          Keluar
        </button>
      </div>
    </aside>
  );
}

--- FILE: ./components/tables/AkunTable.tsx ---



--- FILE: ./pages/auth/LoginPage.tsx ---

import { LoginForm } from "@/components/forms/LoginForm";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faBookOpen } from "@fortawesome/free-solid-svg-icons";
import loginBg from "@/assets/login-bg.png"; 
import { ThemeToggle } from "@/components/ThemeToggle";

export default function LoginPage() {
  return (
    <div className="flex min-h-screen w-full overflow-hidden bg-background-light dark:bg-background-dark">

      <div className="absolute top-4 right-4 z-50">
        <ThemeToggle variant="simple"/>
      </div>
      
      {/* --- Bagian Kiri: Branding & Image (Hanya muncul di Desktop) --- */}
      <div className="relative hidden w-1/2 flex-col justify-between overflow-hidden bg-surface-dark lg:flex">
        {/* Background Image dengan Overlay */}
        <div 
          className="absolute inset-0 h-full w-full bg-cover bg-center opacity-60 transition-transform duration-1000 hover:scale-105"
          style={{ backgroundImage: `url(${loginBg})` }}
        />
        
        {/* Gradient Overlay untuk keterbacaan teks */}
        <div className="absolute inset-0 bg-gradient-to-b from-background-dark/30 to-background-dark/90" />

        {/* Konten Branding */}
        <div className="relative z-10 flex h-full flex-col justify-between p-12">
          <div>
            <div className="flex items-center gap-3">
              <div className="flex h-10 w-10 items-center justify-center rounded-lg bg-primary text-white shadow-lg shadow-primary/20">
                <FontAwesomeIcon icon={faBookOpen} />
              </div>
              <span className="text-xl font-bold tracking-wide text-white font-display">HalaqahId</span>
            </div>
          </div>

          <div className="max-w-lg">
            <h2 className="mb-4 text-4xl font-bold leading-tight text-white font-display">
              "Recite: In the name of thy Lord who created..."
            </h2>
            <p className="text-lg font-light leading-relaxed text-gray-200">
              Kelola santri, pantau hafalan, dan organisir halaqah Anda dengan lebih efisien dan terstruktur.
            </p>
          </div>

          {/* Stepper Indikator (Dekoratif) */}
          <div className="flex gap-2">
            <div className="h-1.5 w-10 rounded-full bg-primary" />
            <div className="h-1.5 w-3 rounded-full bg-white/30" />
            <div className="h-1.5 w-3 rounded-full bg-white/30" />
          </div>
        </div>
      </div>

      {/* --- Bagian Kanan: Form Login --- */}
      <div className="relative flex w-full flex-col items-center justify-center bg-surface-light p-6 dark:bg-background-dark lg:w-1/2">
        
        {/* Mobile Header Logo (Hanya muncul di layar kecil) */}
        <div className="absolute left-8 top-8 flex items-center gap-2 lg:hidden">
          <div className="flex h-9 w-9 items-center justify-center rounded-lg bg-primary text-white">
            <FontAwesomeIcon icon={faBookOpen} className="text-lg" />
          </div>
          <span className="text-xl font-bold dark:text-white font-display">HalaqahId</span>
        </div>

        <div className="mx-auto w-full max-w-md space-y-8">
          {/* Header Teks */}
          <div className="space-y-2 text-center lg:text-left">
            <h2 className="text-3xl font-bold tracking-tight text-text-primary-light dark:text-text-primary-dark font-display">
              Assalamu'alaikum, Ahlan Wa Sahlan
            </h2>
            <p className="text-base text-text-secondary-light dark:text-text-secondary-dark">
              Silakan masuk untuk mengakses Dashboard Halaqah Anda.
            </p>
          </div>

          {/* Pemanggilan Komponen LoginForm */}
          <div className="mt-8">
            <LoginForm />
          </div>

          {/* Footer Form */}
          <div className="text-center">
            <p className="text-sm text-text-secondary-light dark:text-gray-400">
              Belum memiliki akun?{" "}
              <a href="#" className="font-semibold text-primary hover:text-primary-dark transition-colors">
                Daftarkan Lembaga
              </a>
            </p>
          </div>
        </div>

        {/* Footer Copyright */}
        <div className="absolute bottom-8 left-0 w-full text-center">
          <p className="text-xs text-text-secondary-light/60 dark:text-gray-600">
             2026 Halaqah Management System. All rights reserved.
          </p>
        </div>
      </div>
    </div>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaMuhafiz/BuatAkun.tsx ---

import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { AkunForm } from "@/components/forms/AkunForm";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faUserTie, faPlus } from "@fortawesome/free-solid-svg-icons";

interface BuatAkunProps {
  onSuccess: () => void;
}

export function BuatAkun({ onSuccess }: BuatAkunProps) {
  return (
    <Dialog>
      <DialogTrigger asChild>
        <Button className="bg-primary hover:bg-primary-dark text-white">
          <FontAwesomeIcon icon={faPlus} className="mr-2" />
          Tambah Muhafidz
        </Button>
      </DialogTrigger>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <FontAwesomeIcon icon={faUserTie} />
            Buat Akun Muhafidz Baru
          </DialogTitle>
        </DialogHeader>
        <AkunForm onSuccess={onSuccess} />
      </DialogContent>
    </Dialog>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaMuhafiz/DaftarAkun.tsx ---

import { type Muhafiz } from "@/services/akunService";
import { Button } from "@/components/ui/button";
import { Skeleton } from "@/components/ui/skeleton";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faUserTie, 
  faEnvelope,
  faEdit,
  faTrash,
  faPlus
} from "@fortawesome/free-solid-svg-icons";
import { MoreHorizontalIcon } from "lucide-react";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

interface DaftarAkunProps {
  muhafizList: Muhafiz[];
  isLoading: boolean;
  onEditClick: (muhafiz: Muhafiz) => void;
  onDeleteClick: (muhafiz: Muhafiz) => void;
  onRefresh: () => void;
  onCreateClick: () => void;
}

export function DaftarAkun({ 
  muhafizList, 
  isLoading, 
  onEditClick, 
  onDeleteClick, 
  onCreateClick
}: DaftarAkunProps) {
  
  if (isLoading) {
    return (
      <div className="p-6 space-y-4">
        {[1, 2, 3].map((i) => (
          <div key={i} className="flex items-center gap-4">
            <Skeleton className="h-12 w-12 rounded-full" />
            <div className="space-y-2 flex-1">
              <Skeleton className="h-4 w-1/4" />
              <Skeleton className="h-3 w-1/2" />
            </div>
            <Skeleton className="h-8 w-20" />
          </div>
        ))}
      </div>
    );
  }

  if (muhafizList.length === 0) {
    return (
      <div className="p-12 text-center">
        <FontAwesomeIcon icon={faUserTie} className="text-5xl text-text-secondary-light dark:text-text-secondary-dark mb-4" />
        <h4 className="font-medium dark:text-white mb-2">Belum ada muhafidz</h4>
        <p className="text-text-secondary dark:text-text-secondary-dark mb-4">
          Mulai dengan menambahkan akun muhafidz baru
        </p>
        <Button onClick={onCreateClick}>
          <FontAwesomeIcon icon={faPlus} className="mr-2" />
          Tambah Muhafidz Pertama
        </Button>
      </div>
    );
  }

  return (
    <div className="overflow-x-auto">
      <table className="w-full">
        <thead className="bg-accent/30 dark:bg-background-dark/50 text-muted-foreground font-medium">
          <tr>
            <th className="px-6 py-4 text-left">ID</th>
            <th className="px-6 py-4 text-left">Username</th>
            <th className="px-6 py-4 text-left">Email</th>
            <th className="px-6 py-4 text-left">Role</th>
            <th className="px-6 py-4 text-left">Status</th>
            <th className="px-6 py-4 text-left">Aksi</th>
          </tr>
        </thead>
        <tbody className="divide-y divide-border dark:divide-border-dark">
          {muhafizList.map((muhafiz) => (
            <tr key={muhafiz.id_user} className="hover:bg-accent/5 dark:hover:bg-background-dark/30 transition-colors">
              <td className="px-6 py-4">
                <span className="inline-flex items-center rounded-full bg-primary/10 px-3 py-1 text-xs font-medium text-primary">
                  #{muhafiz.id_user}
                </span>
              </td>
              <td className="px-6 py-4 dark:text-text-secondary-dark">
                {muhafiz.username || "Belum diisi"}
              </td>
              <td className="px-6 py-4">
                <div className="flex items-center gap-2">
                  <FontAwesomeIcon icon={faEnvelope} className="text-sm text-text-secondary-light dark:text-text-secondary-dark" />
                  <span className="font-medium dark:text-white">{muhafiz.email}</span>
                </div>
              </td>
              <td className="px-6 py-4">
                <span className="inline-flex items-center rounded-full bg-blue-100 dark:bg-blue-900/30 px-3 py-1 text-xs font-medium text-blue-700 dark:text-blue-300">
                  {muhafiz.role}
                </span>
              </td>
              <td className="px-6 py-4">
                <span className="inline-flex items-center rounded-full bg-green-100 dark:bg-green-900/30 px-3 py-1 text-xs font-medium text-green-700 dark:text-green-300">
                  Aktif
                </span>
              </td>
              <td className="px-6 py-4">
                    <DropdownMenu>
                        <DropdownMenuTrigger asChild>
                        <Button variant="ghost" size="icon" className="h-8 w-8">
                            <MoreHorizontalIcon className="h-4 w-4" />
                        </Button>
                        </DropdownMenuTrigger>
                        <DropdownMenuContent align="end" className="w-40">
                        <DropdownMenuLabel>Aksi</DropdownMenuLabel>
                        <DropdownMenuGroup>
                            <DropdownMenuItem onClick={() => onEditClick(muhafiz)}>
                            <FontAwesomeIcon icon={faEdit} className="mr-2 h-3 w-3" />
                            <span>Edit</span>
                            </DropdownMenuItem>
                            <DropdownMenuItem 
                            onClick={() => onDeleteClick(muhafiz)}
                            className="text-destructive focus:text-destructive"
                            >
                            <FontAwesomeIcon icon={faTrash} className="mr-2 h-3 w-3" />
                            <span>Hapus</span>
                            </DropdownMenuItem>
                        </DropdownMenuGroup>
                        </DropdownMenuContent>
                    </DropdownMenu>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaMuhafiz/DeleteAkun.tsx ---

import { useState } from "react";
import { akunService, type Muhafiz } from "@/services/akunService";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faTrash, faXmark } from "@fortawesome/free-solid-svg-icons";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from "@/components/ui/dialog";

interface DeleteConfirmationProps {
  muhafiz: Muhafiz | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess: () => void;
}

export function DeleteAkun({ muhafiz, isOpen, onClose, onSuccess }: DeleteConfirmationProps) {
  const [confirmText, setConfirmText] = useState("");
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState("");

  const handleDelete = async () => {
    if (!muhafiz || confirmText !== "hapus") return;

    setIsLoading(true);
    setError("");

    try {
      const response = await akunService.deleteMuhafiz(muhafiz.id_user);
      
      if (response.success) {
        onSuccess();
        handleClose();
      }
    } catch (err: any) {
      const message = err.response?.data?.message || "Gagal menghapus muhafidz";
      setError(message);
      console.error("Delete error:", err);
    } finally {
      setIsLoading(false);
    }
  };

  const handleClose = () => {
    setConfirmText("");
    setError("");
    onClose();
  };

  return (
    <Dialog open={isOpen} onOpenChange={handleClose}>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2 text-destructive">
            <FontAwesomeIcon icon={faTrash} />
            Hapus Muhafidz?
          </DialogTitle>
          <DialogDescription>
            <div className="space-y-3">
              <p>Apakah Anda yakin ingin menghapus muhafidz ini?</p>
              <div className="bg-destructive/10 border border-destructive/20 rounded-lg p-3">
                <p className="font-semibold text-destructive">{muhafiz?.username}</p>
                <p className="text-sm text-destructive/80">{muhafiz?.email}</p>
                <p className="text-xs mt-2">ID: #{muhafiz?.id_user}</p>
              </div>
              <p className="text-sm text-destructive">
                <strong>PERINGATAN:</strong> Tindakan ini tidak dapat dibatalkan.
              </p>
            </div>
          </DialogDescription>
        </DialogHeader>

        {/* Error Alert */}
        {error && (
          <Alert variant="destructive">
            <FontAwesomeIcon icon={faXmark} className="mr-2" />
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        )}

        <div className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="confirm-delete">
              Ketik <span className="font-bold text-destructive">"hapus"</span> untuk konfirmasi
            </Label>
            <Input
              id="confirm-delete"
              value={confirmText}
              onChange={(e) => setConfirmText(e.target.value)}
              placeholder="Ketik 'hapus'"
              className={confirmText && confirmText !== "hapus" ? "border-destructive" : ""}
              disabled={isLoading}
            />
            {confirmText && confirmText !== "hapus" && (
              <p className="text-sm text-destructive">Kata konfirmasi tidak sesuai</p>
            )}
          </div>
        </div>
        
        <DialogFooter>
          <Button
            variant="outline"
            onClick={handleClose}
            disabled={isLoading}
          >
            Batal
          </Button>
          <Button
            variant="destructive"
            onClick={handleDelete}
            disabled={confirmText !== "hapus" || isLoading}
            className="gap-2"
          >
            <FontAwesomeIcon icon={faTrash} />
            {isLoading ? "Menghapus..." : "Hapus Permanent"}
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaMuhafiz/EditAkun.tsx ---

import { useState, useEffect } from "react";
import { akunService, type Muhafiz } from "@/services/akunService";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faCheck, faXmark, faEdit } from "@fortawesome/free-solid-svg-icons";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from "@/components/ui/dialog";

interface EditAkunProps {
  muhafiz: Muhafiz | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess: () => void;
}

export function EditAkun({ muhafiz, isOpen, onClose, onSuccess }: EditAkunProps) {
  const [formData, setFormData] = useState({
    username: "",
    email: ""
  });
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState("");
  const [success, setSuccess] = useState("");

  // Inisialisasi form data saat muhafiz berubah
  useEffect(() => {
    if (muhafiz) {
      setFormData({
        username: muhafiz.username || "",
        email: muhafiz.email
      });
    }
  }, [muhafiz]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!muhafiz) return;

    setIsLoading(true);
    setError("");
    setSuccess("");

    try {
      const response = await akunService.updateMuhafiz(muhafiz.id_user, formData);
      
      if (response.success) {
        setSuccess("Data muhafidz berhasil diperbarui!");
        setTimeout(() => {
          onSuccess();
          onClose();
        }, 1000);
      }
    } catch (err: any) {
      const message = err.response?.data?.message || "Gagal memperbarui data";
      setError(message);
      console.error("Edit error:", err);
    } finally {
      setIsLoading(false);
    }
  };

  const handleClose = () => {
    setFormData({ username: "", email: "" });
    setError("");
    setSuccess("");
    onClose();
  };

  return (
    <Dialog open={isOpen} onOpenChange={handleClose}>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <FontAwesomeIcon icon={faEdit} />
            Edit Data Muhafidz
          </DialogTitle>
          <DialogDescription>
            Edit informasi muhafidz #{muhafiz?.id_user}
          </DialogDescription>
        </DialogHeader>

        {/* Success Alert */}
        {success && (
          <Alert variant="default" className="bg-green-50 border-green-200 text-green-800">
            <FontAwesomeIcon icon={faCheck} className="mr-2" />
            <AlertDescription>{success}</AlertDescription>
          </Alert>
        )}

        {/* Error Alert */}
        {error && (
          <Alert variant="destructive">
            <FontAwesomeIcon icon={faXmark} className="mr-2" />
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        )}

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="username">Username</Label>
            <Input
              id="username"
              value={formData.username}
              onChange={(e) => setFormData({...formData, username: e.target.value})}
              placeholder="Masukkan username"
              required
              disabled={isLoading}
            />
          </div>
          
          <div className="space-y-2">
            <Label htmlFor="email">Email</Label>
            <Input
              id="email"
              type="email"
              value={formData.email}
              onChange={(e) => setFormData({...formData, email: e.target.value})}
              placeholder="Masukkan email"
              required
              disabled={isLoading}
            />
          </div>
          
          <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
            <p className="text-sm text-yellow-800">
              <strong>Perhatian:</strong> Pastikan email belum digunakan oleh akun lain.
            </p>
          </div>
          
          <DialogFooter>
            <Button
              type="button"
              variant="outline"
              onClick={handleClose}
              disabled={isLoading}
            >
              Batal
            </Button>
            <Button
              type="submit"
              disabled={isLoading || !formData.username.trim() || !formData.email.trim()}
            >
              {isLoading ? "Menyimpan..." : "Simpan Perubahan"}
            </Button>
          </DialogFooter>
        </form>
      </DialogContent>
    </Dialog>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaMuhafiz/index.tsx ---

import { useState, useEffect } from "react";
import { useAuth } from "@/context/AuthContext";
import { akunService, type Muhafiz } from "@/services/akunService";
import { BuatAkun } from "./BuatAkun";
import { DaftarAkun } from "./DaftarAkun";
import { EditAkun } from "./EditAkun";
import { DeleteAkun } from "./DeleteAkun";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faUserTie, 
  faEnvelope,
  faIdCard,
  faCheck,
  faXmark
} from "@fortawesome/free-solid-svg-icons";

export default function KelolaMuhafizPage() {
  const { user } = useAuth();
  const [muhafizList, setMuhafizList] = useState<Muhafiz[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState("");
  const [success, setSuccess] = useState("");
  
  // State untuk edit dan delete
  const [editingMuhafiz, setEditingMuhafiz] = useState<Muhafiz | null>(null);
  const [deletingMuhafiz, setDeletingMuhafiz] = useState<Muhafiz | null>(null);
  const [isEditOpen, setIsEditOpen] = useState(false);
  const [isDeleteOpen, setIsDeleteOpen] = useState(false);

  // Load data muhafiz
  useEffect(() => {
    loadMuhafiz();
  }, []);

  const loadMuhafiz = async () => {
    setIsLoading(true);
    setError("");
    try {
      const response = await akunService.getAllMuhafiz();
      if (response.success) {
        setMuhafizList(response.data);
      }
    } catch (err: any) {
      setError("Gagal memuat data muhafiz: " + err.message);
      console.error("Load muhafiz error:", err);
    } finally {
      setIsLoading(false);
    }
  };

  const handleRegisterSuccess = () => {
    setSuccess("Akun muhafidz berhasil dibuat!");
    loadMuhafiz();
    setTimeout(() => setSuccess(""), 3000);
  };

  const handleEditClick = (muhafiz: Muhafiz) => {
    setEditingMuhafiz(muhafiz);
    setIsEditOpen(true);
  };

  const handleEditSuccess = () => {
    setSuccess("Data muhafidz berhasil diperbarui!");
    loadMuhafiz();
    setTimeout(() => setSuccess(""), 3000);
  };

  const handleDeleteClick = (muhafiz: Muhafiz) => {
    setDeletingMuhafiz(muhafiz);
    setIsDeleteOpen(true);
  };

  const handleDeleteSuccess = () => {
    setSuccess("Muhafidz berhasil dihapus!");
    loadMuhafiz();
    setTimeout(() => setSuccess(""), 3000);
  };

  // Cek apakah user adalah superadmin
  if (user?.role !== "superadmin") {
    return (
      <div className="flex flex-col items-center justify-center min-h-[400px] text-center p-6">
        <FontAwesomeIcon icon={faUserTie} className="text-6xl text-destructive mb-4" />
        <h2 className="text-2xl font-bold dark:text-white mb-2">Akses Ditolak</h2>
        <p className="text-text-secondary dark:text-text-secondary-dark">
          Hanya Kepala Muhafidz yang dapat mengakses halaman ini.
        </p>
      </div>
    );
  }

  return (
    <div className="space-y-6 animate-in fade-in duration-500">
      {/* Header */}
      <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <div>
          <h2 className="text-2xl font-bold dark:text-white">Kelola Akun Muhafidz</h2>
          <p className="text-text-secondary dark:text-text-secondary-dark text-sm">
            Kelola akun muhafidz di bawah yayasan Anda
          </p>
        </div>

        {/* Tombol Buat Akun */}
        <BuatAkun onSuccess={handleRegisterSuccess} />
      </div>

      {/* Success Alert */}
      {success && (
        <Alert variant="default" className="bg-green-50 border-green-200 text-green-800 dark:bg-green-900/20 dark:border-green-800 dark:text-green-300">
          <FontAwesomeIcon icon={faCheck} className="mr-2" />
          <AlertDescription>{success}</AlertDescription>
        </Alert>
      )}

      {/* Error Alert */}
      {error && (
        <Alert variant="destructive">
          <FontAwesomeIcon icon={faXmark} className="mr-2" />
          <AlertDescription>{error}</AlertDescription>
        </Alert>
      )}

      {/* Stats Card */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center">
              <FontAwesomeIcon icon={faUserTie} className="text-primary" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Total Muhafidz</p>
              <p className="text-2xl font-bold dark:text-white">
                {isLoading ? "--" : muhafizList.length}
              </p>
            </div>
          </div>
        </div>

        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-green-100 dark:bg-green-900/20 flex items-center justify-center">
              <FontAwesomeIcon icon={faIdCard} className="text-green-600 dark:text-green-400" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Role</p>
              <p className="text-2xl font-bold dark:text-white">Muhafiz</p>
            </div>
          </div>
        </div>

        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center">
              <FontAwesomeIcon icon={faEnvelope} className="text-blue-600 dark:text-blue-400" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Status</p>
              <p className="text-2xl font-bold dark:text-white">Aktif</p>
            </div>
          </div>
        </div>
      </div>

      {/* Tabel Daftar Akun */}
      <div className="rounded-xl border border-border bg-card dark:bg-surface-dark shadow-sm overflow-hidden">
        <div className="p-6 border-b border-border dark:border-border-dark">
          <h3 className="font-semibold text-lg dark:text-white">Daftar Muhafidz</h3>
          <p className="text-sm text-text-secondary dark:text-text-secondary-dark">
            Semua akun muhafidz yang terdaftar
          </p>
        </div>

        <DaftarAkun
          muhafizList={muhafizList}
          isLoading={isLoading}
          onEditClick={handleEditClick}
          onDeleteClick={handleDeleteClick}
          onRefresh={loadMuhafiz}
          onCreateClick={handleRegisterSuccess}
        />
      </div>

      {/* Dialog Edit Akun */}
      <EditAkun
        muhafiz={editingMuhafiz}
        isOpen={isEditOpen}
        onClose={() => setIsEditOpen(false)}
        onSuccess={handleEditSuccess}
      />

      {/* Dialog Konfirmasi Delete */}
      <DeleteAkun
        muhafiz={deletingMuhafiz}
        isOpen={isDeleteOpen}
        onClose={() => setIsDeleteOpen(false)}
        onSuccess={handleDeleteSuccess}
      />

      {/* Informasi Tambahan */}
      <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
        <div className="flex items-start gap-3">
          <div className="h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center flex-shrink-0">
            <FontAwesomeIcon icon={faIdCard} className="text-blue-600 dark:text-blue-400" />
          </div>
          <div>
            <h4 className="font-semibold dark:text-white mb-2">Informasi Penting</h4>
            <ul className="text-sm text-text-secondary dark:text-text-secondary-dark space-y-2">
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span>Password akan di-hash secara otomatis oleh sistem</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span>Akun yang dibuat langsung aktif dan dapat digunakan untuk login</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span>Pastikan email yang digunakan belum terdaftar sebelumnya</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span>Edit hanya mengubah username/email, tidak bisa mengubah password</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span>Hapus muhafidz bersifat soft delete (data tidak benar-benar hilang)</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  );
}

--- FILE: ./pages/kepala-muhafidz/index.tsx ---

import { Routes, Route, Navigate } from "react-router-dom";
import KepalaMuhafidzDashboard from "./Dashboard";
import KelolaMuhafizPage from "./KelolaMuhafiz";
import KelolaHalaqahPage from "./KelolaHalaqah"; 

export default function KepalaMuhafidzPage() {
  return (
    <Routes>
      <Route index element={<KepalaMuhafidzDashboard />} />
      <Route path="muhafiz" element={<KelolaMuhafizPage />} />
      <Route path="halaqah" element={<KelolaHalaqahPage />} /> 
      <Route path="laporan" element={<div>Lihat Laporan</div>} />
      <Route path="*" element={<Navigate to="." replace />} />
    </Routes>
  );
}

--- FILE: ./pages/kepala-muhafidz/Dashboard.tsx ---

import { useState, useEffect } from 'react';
import { akunService } from '@/services/akunService'; // Sesuaikan path

export default function KepalaMuhafidzDashboard() {
  const [muhafizData, setMuhafizData] = useState<any[]>([]);
  const [totalMuhafiz, setTotalMuhafiz] = useState<number>(0);
  const [loading, setLoading] = useState<boolean>(true);
  const [error, setError] = useState<string | null>(null);

  // Fetch data dari API
  useEffect(() => {
    const fetchMuhafizData = async () => {
      try {
        setLoading(true);
        setError(null);
        
        const response = await akunService.getAllMuhafiz();
        
        if (response.success && response.data) {
          setMuhafizData(response.data);
          setTotalMuhafiz(response.data.length);
        } else {
          setError(response.message || 'Gagal mengambil data muhafiz');
        }
      } catch (err: any) {
        console.error('Error fetching muhafiz data:', err);
        setError(err.message || 'Terjadi kesalahan saat mengambil data');
      } finally {
        setLoading(false);
      }
    };

    fetchMuhafizData();
  }, []);

  // Menghitung statistik sederhana
  const totalHalaqah = muhafizData.length * 2; // Contoh: asumsi setiap muhafiz menangani 2 halaqah
  const kehadiranHariIni = muhafizData.length > 0 ? '85%' : '0%'; // Data dummy, bisa diganti dengan API jika ada

  return (
    <div className="space-y-6">
      <header className="text-left">
        <h2 className="text-2xl font-bold dark:text-white">Dashboard Kepala Muhafidz</h2>
        <p className="text-text-secondary dark:text-text-secondary-dark text-sm">
          Selamat datang di dashboard manajemen halaqah
        </p>
      </header>

      {/* Loading State */}
      {loading && (
        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex justify-center items-center py-10">
            <div className="animate-spin rounded-full h-10 w-10 border-b-2 border-primary"></div>
            <span className="ml-3 dark:text-white">Memuat data...</span>
          </div>
        </div>
      )}

      {/* Error State */}
      {error && !loading && (
        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="text-center py-6">
            <div className="text-red-500 mb-2">
              <svg className="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <h3 className="text-lg font-semibold dark:text-white mb-2">Gagal Memuat Data</h3>
            <p className="text-text-secondary dark:text-text-secondary-dark">{error}</p>
            <button
              onClick={() => window.location.reload()}
              className="mt-4 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"
            >
              Coba Lagi
            </button>
          </div>
        </div>
      )}

      {/* Widget/Statistik - Tampilkan hanya jika tidak loading dan tidak error */}
      {!loading && !error && (
        <>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
              <h3 className="font-semibold text-lg mb-2 dark:text-white">Total Muhafiz</h3>
              <p className="text-3xl font-bold text-primary">{totalMuhafiz}</p>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark mt-2">
                Total musyrif yang terdaftar
              </p>
            </div>
            <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
              <h3 className="font-semibold text-lg mb-2 dark:text-white">Total Halaqah</h3>
              <p className="text-3xl font-bold text-primary">{totalHalaqah}</p>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark mt-2">
                Estimasi jumlah halaqah aktif
              </p>
            </div>
            <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
              <h3 className="font-semibold text-lg mb-2 dark:text-white">Kehadiran Hari Ini</h3>
              <p className="text-3xl font-bold text-primary">{kehadiranHariIni}</p>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark mt-2">
                Rata-rata kehadiran musyrif
              </p>
            </div>
          </div>

          {/* Tabel Daftar Muhafiz */}
          <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
            <div className="flex justify-between items-center mb-4">
              <h3 className="font-semibold text-lg dark:text-white">Daftar Muhafiz</h3>
              <span className="text-sm text-text-secondary dark:text-text-secondary-dark">
                Total: {totalMuhafiz} orang
              </span>
            </div>

            {muhafizData.length === 0 ? (
              <div className="text-center py-10">
                <svg className="w-16 h-16 mx-auto text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1} d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <p className="mt-4 dark:text-white">Belum ada data muhafiz</p>
                <p className="text-sm text-text-secondary dark:text-text-secondary-dark">
                  Data akan muncul setelah muhafiz terdaftar
                </p>
              </div>
            ) : (
              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead>
                    <tr className="border-b border-border dark:border-border-dark">
                      <th className="text-left py-3 px-4 dark:text-white font-medium">No</th>
                      <th className="text-left py-3 px-4 dark:text-white font-medium">Username</th>
                      <th className="text-left py-3 px-4 dark:text-white font-medium">Email</th>
                      <th className="text-left py-3 px-4 dark:text-white font-medium">ID</th>
                    </tr>
                  </thead>
                  <tbody>
                    {muhafizData.map((muhafiz, index) => (
                      <tr key={muhafiz.id_user} className="border-b border-border dark:border-border-dark hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                        <td className="py-3 px-4 dark:text-white">{index + 1}</td>
                        <td className="py-3 px-4 dark:text-white">
                          {muhafiz.username || 'Tidak ada username'}
                        </td>
                        <td className="py-3 px-4 dark:text-white">{muhafiz.email}</td>
                        <td className="py-3 px-4 dark:text-white">{muhafiz.id_user}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            )}
          </div>
        </>
      )}
    </div>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaHalaqah/index.tsx ---

import { useState, useEffect } from "react";
import { useAuth } from "@/context/AuthContext";
import { halaqahService, type Halaqah } from "@/services/halaqahService";
import { BuatHalaqah } from "./BuatHalaqah";
import { DaftarHalaqah } from "./DaftarHalaqah";
import { EditHalaqah } from "./EditHalaqah";
import { DeleteHalaqah } from "./DeleteHalaqah";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faBook, 
  faUsers,
  faCheck,
  faXmark
} from "@fortawesome/free-solid-svg-icons";

export default function KelolaHalaqahPage() {
  const { user } = useAuth();
  const [halaqahList, setHalaqahList] = useState<Halaqah[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState("");
  const [success, setSuccess] = useState("");
  
  // State untuk edit dan delete
  const [editingHalaqah, setEditingHalaqah] = useState<Halaqah | null>(null);
  const [deletingHalaqah, setDeletingHalaqah] = useState<Halaqah | null>(null);
  const [isEditOpen, setIsEditOpen] = useState(false);
  const [isDeleteOpen, setIsDeleteOpen] = useState(false);

  // Load data halaqah
  useEffect(() => {
    loadHalaqah();
  }, []);

  const loadHalaqah = async () => {
    setIsLoading(true);
    setError("");
    try {
      const response = await halaqahService.getAllHalaqah();
      if (response.success) {
        setHalaqahList(response.data);
      }
    } catch (err: any) {
      setError("Gagal memuat data halaqah");
      console.error("Load halaqah error:", err);
    } finally {
      setIsLoading(false);
    }
  };

  const handleCreateSuccess = () => {
    setSuccess("Halaqah berhasil dibuat!");
    loadHalaqah();
    setTimeout(() => setSuccess(""), 3000);
  };

  const handleEditClick = (halaqah: Halaqah) => {
    setEditingHalaqah(halaqah);
    setIsEditOpen(true);
  };

  const handleEditSuccess = () => {
    setSuccess("Halaqah berhasil diperbarui!");
    loadHalaqah();
    setTimeout(() => setSuccess(""), 3000);
  };

  const handleDeleteClick = (halaqah: Halaqah) => {
    setDeletingHalaqah(halaqah);
    setIsDeleteOpen(true);
  };

  const handleDeleteSuccess = () => {
    setSuccess("Halaqah berhasil dihapus!");
    loadHalaqah();
    setTimeout(() => setSuccess(""), 3000);
  };

  // Cek apakah user adalah superadmin
  if (user?.role !== "superadmin") {
    return (
      <div className="flex flex-col items-center justify-center min-h-[400px] text-center p-6">
        <FontAwesomeIcon icon={faBook} className="text-6xl text-destructive mb-4" />
        <h2 className="text-2xl font-bold dark:text-white mb-2">Akses Ditolak</h2>
        <p className="text-text-secondary dark:text-text-secondary-dark">
          Hanya Kepala Muhafidz yang dapat mengakses halaman ini.
        </p>
      </div>
    );
  }

  // Hitung statistik
  const totalHalaqah = halaqahList.length;
  const totalMuhafiz = new Set(halaqahList.map(h => h.muhafidz_id)).size;
  const totalSantri = halaqahList.reduce((sum, h) => sum + (h.jumlah_santri || 0), 0);

  return (
    <div className="space-y-6 animate-in fade-in duration-500">
      {/* Header */}
      <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <div>
          <h2 className="text-2xl font-bold dark:text-white">Kelola Halaqah</h2>
          <p className="text-text-secondary dark:text-text-secondary-dark text-sm">
            Kelola halaqah di bawah yayasan Anda
          </p>
        </div>

        {/* Tombol Buat Halaqah */}
        <BuatHalaqah onSuccess={handleCreateSuccess} />
      </div>

      {/* Success Alert */}
      {success && (
        <Alert variant="default" className="bg-green-50 border-green-200 text-green-800">
          <FontAwesomeIcon icon={faCheck} className="mr-2" />
          <AlertDescription>{success}</AlertDescription>
        </Alert>
      )}

      {/* Error Alert */}
      {error && (
        <Alert variant="destructive">
          <FontAwesomeIcon icon={faXmark} className="mr-2" />
          <AlertDescription>{error}</AlertDescription>
        </Alert>
      )}

      {/* Stats Card */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center">
              <FontAwesomeIcon icon={faBook} className="text-primary" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Total Halaqah</p>
              <p className="text-2xl font-bold dark:text-white">{totalHalaqah}</p>
            </div>
          </div>
        </div>

        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center">
              <FontAwesomeIcon icon={faUsers} className="text-blue-600 dark:text-blue-400" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Total Muhafidz</p>
              <p className="text-2xl font-bold dark:text-white">{totalMuhafiz}</p>
            </div>
          </div>
        </div>

        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-green-100 dark:bg-green-900/20 flex items-center justify-center">
              <FontAwesomeIcon icon={faUsers} className="text-green-600 dark:text-green-400" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Total Santri</p>
              <p className="text-2xl font-bold dark:text-white">{totalSantri}</p>
            </div>
          </div>
        </div>
      </div>

      {/* Tabel Daftar Halaqah */}
      <div className="rounded-xl border border-border bg-card dark:bg-surface-dark shadow-sm overflow-hidden">
        <div className="p-6 border-b border-border dark:border-border-dark">
          <h3 className="font-semibold text-lg dark:text-white">Daftar Halaqah</h3>
          <p className="text-sm text-text-secondary dark:text-text-secondary-dark">
            Semua halaqah yang terdaftar
          </p>
        </div>

        <DaftarHalaqah
          halaqahList={halaqahList}
          isLoading={isLoading}
          onEditClick={handleEditClick}
          onDeleteClick={handleDeleteClick}
          onRefresh={loadHalaqah}
          onCreateClick={handleCreateSuccess}
        />
      </div>

      {/* Dialog Edit Halaqah */}
      <EditHalaqah
        halaqah={editingHalaqah}
        isOpen={isEditOpen}
        onClose={() => setIsEditOpen(false)}
        onSuccess={handleEditSuccess}
      />

      {/* Dialog Konfirmasi Delete */}
      <DeleteHalaqah
        halaqah={deletingHalaqah}
        isOpen={isDeleteOpen}
        onClose={() => setIsDeleteOpen(false)}
        onSuccess={handleDeleteSuccess}
      />

      {/* Informasi Tambahan */}
      <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
        <div className="flex items-start gap-3">
          <div className="h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center flex-shrink-0">
            <FontAwesomeIcon icon={faBook} className="text-blue-600 dark:text-blue-400" />
          </div>
          <div>
            <h4 className="font-semibold dark:text-white mb-2">Informasi Penting</h4>
            <ul className="text-sm text-text-secondary dark:text-text-secondary-dark space-y-2">
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span><strong>Bacaan:</strong> Fokus pada pembelajaran membaca Al-Quran</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span><strong>Hafalan:</strong> Fokus pada menghafal Al-Quran</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span><strong>Khusus:</strong> Program khusus seperti Tahfidz, Tafsir, dll.</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span>Setiap muhafidz hanya dapat memimpin 1 halaqah</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-primary"></span>
                <span>Hapus halaqah akan memutus relasi dengan muhafidz dan santri</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaHalaqah/BuatHalaqah.tsx ---

import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { HalaqahForm } from "@/components/forms/HalaqahForm";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faBook, faPlus } from "@fortawesome/free-solid-svg-icons";

interface BuatHalaqahProps {
  onSuccess: () => void;
}

export function BuatHalaqah({ onSuccess }: BuatHalaqahProps) {
  return (
    <Dialog>
      <DialogTrigger asChild>
        <Button className="bg-primary hover:bg-primary-dark text-white">
          <FontAwesomeIcon icon={faPlus} className="mr-2" />
          Tambah Halaqah
        </Button>
      </DialogTrigger>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <FontAwesomeIcon icon={faBook} />
            Buat Halaqah Baru
          </DialogTitle>
        </DialogHeader>
        <HalaqahForm onSuccess={onSuccess} />
      </DialogContent>
    </Dialog>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaHalaqah/DaftarHalaqah.tsx ---

import { type Halaqah } from "@/services/halaqahService";
import { Button } from "@/components/ui/button";
import { Skeleton } from "@/components/ui/skeleton";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faBook, 
  faUserTie,
  faUsers,
  faEdit,
  faTrash,
  faPlus
} from "@fortawesome/free-solid-svg-icons";
import { MoreHorizontalIcon } from "lucide-react";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

interface DaftarHalaqahProps {
  halaqahList: Halaqah[];
  isLoading: boolean;
  onEditClick: (halaqah: Halaqah) => void;
  onDeleteClick: (halaqah: Halaqah) => void;
  onRefresh: () => void;
  onCreateClick: () => void;
}

export function DaftarHalaqah({ 
  halaqahList, 
  isLoading, 
  onEditClick, 
  onDeleteClick, 
  onCreateClick
}: DaftarHalaqahProps) {
  
  if (isLoading) {
    return (
      <div className="p-6 space-y-4">
        {[1, 2, 3].map((i) => (
          <div key={i} className="flex items-center gap-4">
            <Skeleton className="h-12 w-12 rounded-full" />
            <div className="space-y-2 flex-1">
              <Skeleton className="h-4 w-1/4" />
              <Skeleton className="h-3 w-1/2" />
            </div>
            <Skeleton className="h-8 w-20" />
          </div>
        ))}
      </div>
    );
  }

  if (halaqahList.length === 0) {
    return (
      <div className="p-12 text-center">
        <FontAwesomeIcon icon={faBook} className="text-5xl text-text-secondary-light dark:text-text-secondary-dark mb-4" />
        <h4 className="font-medium dark:text-white mb-2">Belum ada halaqah</h4>
        <p className="text-text-secondary dark:text-text-secondary-dark mb-4">
          Mulai dengan membuat halaqah pertama
        </p>
        <Button onClick={onCreateClick}>
          <FontAwesomeIcon icon={faPlus} className="mr-2" />
          Buat Halaqah Pertama
        </Button>
      </div>
    );
  }

  // Fungsi untuk menentukan warna berdasarkan jenis halaqah
  const getJenisColor = (jenis: string) => {
    switch (jenis) {
      case "BACAAN": return "bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300";
      case "HAFALAN": return "bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300";
      case "KHUSUS": return "bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300";
      default: return "bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-300";
    }
  };

  return (
    <div className="overflow-x-auto">
      <table className="w-full">
        <thead className="bg-accent/30 dark:bg-background-dark/50 text-muted-foreground font-medium">
          <tr>
            <th className="px-6 py-4 text-left">ID</th>
            <th className="px-6 py-4 text-left">Nama Halaqah</th>
            <th className="px-6 py-4 text-left">Jenis</th>
            <th className="px-6 py-4 text-left">Muhafidz</th>
            <th className="px-6 py-4 text-left">Jml. Santri</th>
            <th className="px-6 py-4 text-left">Aksi</th>
          </tr>
        </thead>
        <tbody className="divide-y divide-border dark:divide-border-dark">
          {halaqahList.map((halaqah) => (
            <tr key={halaqah.id_halaqah} className="hover:bg-accent/5 dark:hover:bg-background-dark/30 transition-colors">
              <td className="px-6 py-4">
                <span className="inline-flex items-center rounded-full bg-primary/10 px-3 py-1 text-xs font-medium text-primary">
                  #{halaqah.id_halaqah}
                </span>
              </td>
              <td className="px-6 py-4">
                <div className="flex items-center gap-2">
                  <FontAwesomeIcon icon={faBook} className="text-sm text-text-secondary-light dark:text-text-secondary-dark" />
                  <span className="font-medium dark:text-white">{halaqah.nama_halaqah}</span>
                </div>
              </td>
              <td className="px-6 py-4">
                <span className={`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${getJenisColor(halaqah.jenis)}`}>
                  {halaqah.jenis}
                </span>
              </td>
              <td className="px-6 py-4">
                <div className="flex items-center gap-2">
                  <FontAwesomeIcon icon={faUserTie} className="text-sm text-text-secondary-light dark:text-text-secondary-dark" />
                  <div>
                    <p className="font-medium dark:text-white">{halaqah.muhafidz.username}</p>
                    <p className="text-xs text-text-secondary-light dark:text-text-secondary-dark">{halaqah.muhafidz.email}</p>
                  </div>
                </div>
              </td>
              <td className="px-6 py-4">
                <div className="flex items-center gap-2">
                  <FontAwesomeIcon icon={faUsers} className="text-sm text-text-secondary-light dark:text-text-secondary-dark" />
                  <span className="font-medium dark:text-white">{halaqah.jumlah_santri || 0}</span>
                </div>
              </td>
              <td className="px-6 py-4">
                <DropdownMenu>
                  <DropdownMenuTrigger asChild>
                    <Button variant="ghost" size="icon" className="h-8 w-8">
                      <MoreHorizontalIcon className="h-4 w-4" />
                    </Button>
                  </DropdownMenuTrigger>
                  <DropdownMenuContent align="end" className="w-40">
                    <DropdownMenuLabel>Aksi</DropdownMenuLabel>
                    <DropdownMenuGroup>
                      <DropdownMenuItem onClick={() => onEditClick(halaqah)}>
                        <FontAwesomeIcon icon={faEdit} className="mr-2 h-3 w-3" />
                        <span>Edit</span>
                      </DropdownMenuItem>
                      <DropdownMenuItem 
                        onClick={() => onDeleteClick(halaqah)}
                        className="text-destructive focus:text-destructive"
                      >
                        <FontAwesomeIcon icon={faTrash} className="mr-2 h-3 w-3" />
                        <span>Hapus</span>
                      </DropdownMenuItem>
                    </DropdownMenuGroup>
                  </DropdownMenuContent>
                </DropdownMenu>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaHalaqah/EditHalaqah.tsx ---

import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from "@/components/ui/dialog";
import { HalaqahForm } from "@/components/forms/HalaqahForm";

interface EditHalaqahProps {
  halaqah: any | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess: () => void;
}

export function EditHalaqah({ halaqah, isOpen, onClose, onSuccess }: EditHalaqahProps) {
  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle>Edit Halaqah</DialogTitle>
          <DialogDescription>
            Edit informasi halaqah #{halaqah?.id_halaqah}
          </DialogDescription>
        </DialogHeader>
        
        {halaqah && (
          <HalaqahForm
            initialData={{
              id_halaqah: halaqah.id_halaqah,
              nama_halaqah: halaqah.nama_halaqah,
              jenis: halaqah.jenis,
              muhafidz_id: halaqah.muhafidz_id
            }}
            onSuccess={() => {
              onSuccess();
              onClose();
            }}
          />
        )}
      </DialogContent>
    </Dialog>
  );
}

--- FILE: ./pages/kepala-muhafidz/KelolaHalaqah/DeleteHalaqah.tsx ---

import { useState } from "react";
import { halaqahService, type Halaqah } from "@/services/halaqahService";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faTrash, faXmark } from "@fortawesome/free-solid-svg-icons";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from "@/components/ui/dialog";

interface DeleteHalaqahProps {
  halaqah: Halaqah | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess: () => void;
}

export function DeleteHalaqah({ halaqah, isOpen, onClose, onSuccess }: DeleteHalaqahProps) {
  const [confirmText, setConfirmText] = useState("");
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState("");

  const handleDelete = async () => {
    if (!halaqah || confirmText !== "hapus") return;

    setIsLoading(true);
    setError("");

    try {
      const response = await halaqahService.deleteHalaqah(halaqah.id_halaqah);
      
      if (response.success) {
        onSuccess();
        handleClose();
      }
    } catch (err: any) {
      const message = err.response?.data?.message || "Gagal menghapus halaqah";
      setError(message);
      console.error("Delete error:", err);
    } finally {
      setIsLoading(false);
    }
  };

  const handleClose = () => {
    setConfirmText("");
    setError("");
    onClose();
  };

  return (
    <Dialog open={isOpen} onOpenChange={handleClose}>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2 text-destructive">
            <FontAwesomeIcon icon={faTrash} />
            Hapus Halaqah?
          </DialogTitle>
          <DialogDescription>
            <div className="space-y-3">
              <p>Apakah Anda yakin ingin menghapus halaqah ini?</p>
              <div className="bg-destructive/10 border border-destructive/20 rounded-lg p-3">
                <p className="font-semibold text-destructive">{halaqah?.nama_halaqah}</p>
                <p className="text-sm text-destructive/80">Jenis: {halaqah?.jenis}</p>
                <p className="text-sm text-destructive/80">Muhafidz: {halaqah?.muhafidz.username}</p>
                <p className="text-xs mt-2">ID: #{halaqah?.id_halaqah}</p>
              </div>
              <p className="text-sm text-destructive">
                <strong>PERINGATAN:</strong> Hapus halaqah juga akan menghapus semua santri di dalamnya!
              </p>
            </div>
          </DialogDescription>
        </DialogHeader>

        {/* Error Alert */}
        {error && (
          <Alert variant="destructive">
            <FontAwesomeIcon icon={faXmark} className="mr-2" />
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        )}

        <div className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="confirm-delete">
              Ketik <span className="font-bold text-destructive">"hapus"</span> untuk konfirmasi
            </Label>
            <Input
              id="confirm-delete"
              value={confirmText}
              onChange={(e) => setConfirmText(e.target.value)}
              placeholder="Ketik 'hapus'"
              className={confirmText && confirmText !== "hapus" ? "border-destructive" : ""}
              disabled={isLoading}
            />
            {confirmText && confirmText !== "hapus" && (
              <p className="text-sm text-destructive">Kata konfirmasi tidak sesuai</p>
            )}
          </div>
        </div>
        
        <DialogFooter>
          <Button
            variant="outline"
            onClick={handleClose}
            disabled={isLoading}
          >
            Batal
          </Button>
          <Button
            variant="destructive"
            onClick={handleDelete}
            disabled={confirmText !== "hapus" || isLoading}
            className="gap-2"
          >
            <FontAwesomeIcon icon={faTrash} />
            {isLoading ? "Menghapus..." : "Hapus Permanent"}
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}

--- FILE: ./pages/muhafidz/Absensi.tsx ---

import { useState } from "react";
type Status = "hadir" | "absen" | "izin";

interface Halaqah {
  id: number;
  nama: string;
  muhafidz: string;
}

interface Santri {
  id: number;
  nama: string;
  halaqahId: number;
}

interface Absensi {
  santriId: number;
  status: Status;
  keterangan?: string;
}

export default function AbsensiPage() {
  const [_halaqah, _setHalaqah] = useState<Halaqah>({
    id: 1,
    nama: "Halaqah A",
    muhafidz: "Ust. Ahmad",
  });

  const [santri, _setSantri] = useState<Santri[]>([
    { id: 1, nama: "Ahmad", halaqahId: 1 },
    { id: 2, nama: "Burhan", halaqahId: 1 },
    { id: 3, nama: "Cahya", halaqahId: 1 },
    { id: 4, nama: "Dafa", halaqahId: 1 },
    { id: 5, nama: "Ehsan", halaqahId: 1 },
    { id: 6, nama: "Fahri", halaqahId: 1 },
    { id: 7, nama: "Gamal", halaqahId: 1 },
    { id: 8, nama: "Hamzah", halaqahId: 1 },
  ]);

  const [absensi, setAbsensi] = useState<Absensi[]>([
    { santriId: 1, status: "hadir" },
    { santriId: 2, status: "izin", keterangan: "Sakit" },
  ]);

  const handleStatusChange = (santriId: number, status: Status) => {
    setAbsensi((prev) => {
      const exists = prev.find((a) => a.santriId === santriId);

      if (exists) {
        return prev.map((a) =>
          a.santriId === santriId
            ? {
                ...a,
                status,
                keterangan: status === "izin" ? a.keterangan : undefined,
              }
            : a
        );
      }

      return [...prev, { santriId, status }];
    });
  };

  const handleKeteranganChange = (santriId: number, value: string) => {
    setAbsensi((prev) =>
      prev.map((a) =>
        a.santriId === santriId
          ? { ...a, keterangan: value }
          : a
      )
    );
  };

  const handleSubmit = () => {
    const invalid = absensi.find(
      (a) => a.status === "izin" && (!a.keterangan || a.keterangan.trim() === "")
    );

    if (invalid) {
      alert("Gagal menyimpan!\nIzin wajib diisi keterangan.");
      return;
    }

    console.log("Payload ke backend:", {
      tanggal: new Date(),
      absensi,
    });

    alert("Absensi berhasil disimpan");
  };

  const rows = santri.map((s) => {
    const data = absensi.find((a) => a.santriId === s.id);

    return {
      santriId: s.id,
      namaSantri: s.nama,
      status: data?.status ?? "absen",
      keterangan: data?.keterangan,
    };
  });

  const summary = {
    total: rows.length,
    hadir: rows.filter((r) => r.status === "hadir").length,
    izin: rows.filter((r) => r.status === "izin").length,
    absen: rows.filter((r) => r.status === "absen").length,
  };

  const hasInvalidIzin = rows.some(
    (row) =>
      row.status === "izin" &&
      (!row.keterangan || row.keterangan.trim() === "")
  );

  return (
    <div className="space-y-6 animate-in fade-in duration-500">
      <header className="flex flex-col text-left">
        <h2 className="text-2xl font-bold text-foreground dark:text-foreground-dark">
          Absensi Hari Ini
        </h2>
        <p className="text-muted-foreground dark:text-text-secondary-dark text-sm">
          {new Date().toLocaleDateString("id-ID", {
            day: "2-digit",
            month: "long",
            year: "numeric",
          })}
        </p>
      </header>

      <div className="overflow-hidden rounded-xl border border-border dark:border-border-dark bg-card dark:bg-surface-dark shadow-sm">
        <div className="overflow-x-auto">
          <table className="w-full text-sm text-left">
            <thead className="bg-accent/50 dark:bg-background-dark/50 text-foreground dark:text-foreground-dark">
              <tr>
                <th className="px-6 py-4 font-semibold">Nama Santri</th>
                <th className="px-6 py-4 font-semibold">Status</th>
                <th className="px-6 py-4 font-semibold">Keterangan</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-border dark:divide-border-dark">
              {rows.map((row) => (
                <tr
                  key={row.santriId}
                  className={`
                    transition-colors
                    ${
                      row.status === "izin" &&
                      (!row.keterangan || row.keterangan.trim() === "")
                        ? "bg-destructive/10"
                        : "hover:bg-accent/5"
                    }
                  `}
                >
                  <td className="px-6 py-4 font-medium dark:text-foreground-dark">
                    {row.namaSantri}
                  </td>

                  <td className="px-6 py-4">
                    <select
                      value={row.status}
                      onChange={(e) =>
                        handleStatusChange(row.santriId, e.target.value as Status)
                      }
                      className="bg-background dark:bg-background-dark text-foreground dark:text-foreground-dark border border-border dark:border-border-dark rounded-md px-3 py-1.5 focus:ring-2 focus:ring-primary outline-none"
                    >
                      <option value="hadir">Hadir</option>
                      <option value="absen">Absen</option>
                      <option value="izin">Izin</option>
                    </select>
                  </td>

                  <td className="px-6 py-4">
                    {row.status === "izin" ? (
                      <div className="space-y-1">
                        <input
                          type="text"
                          value={row.keterangan || ""}
                          onChange={(e) =>
                            handleKeteranganChange(row.santriId, e.target.value)
                          }
                          placeholder="Alasan izin..."
                          className="w-full max-w-xs rounded-md border px-3 py-1.5 outline-none
                            border-border focus:ring-2 focus:ring-primary"
                        />

                        {(!row.keterangan || row.keterangan.trim() === "") && (
                          <p className="text-xs text-destructive">
                            Keterangan wajib diisi
                          </p>
                        )}
                      </div>
                    ) : (
                      <span className="text-muted italic text-xs">N/A</span>
                    )}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>

      <div className="mt-auto sticky bottom-0 bg-card dark:bg-surface-dark rounded-xl border border-border dark:border-border-dark backdrop-blur">
        <div className="flex items-center justify-between gap-6 px-6 py-5">

          {/* Summary */}
          <div className="flex gap-4">
            {[
              { label: "Total", value: summary.total, color: "text-foreground dark:text-foreground-dark"},
              { label: "Hadir", value: summary.hadir, color: "text-primary" },
              { label: "Izin", value: summary.izin, color: "text-yellow-500" },
              { label: "Absen", value: summary.absen, color: "text-red-500" },
            ].map((item) => (
              <div
                key={item.label}
                className="bg-background/40 dark:bg-background-dark/40 border border-border/40 rounded-2xl px-4 py-3 text-sm shadow-sm"
              >
                <p className="text-muted-foreground">{item.label}</p>
                <p className={`font-bold text-lg ${item.color ?? ""}`}>
                  {item.value}
                </p>
              </div>
            ))}
          </div>

          {/* Action */}
          <button
            onClick={handleSubmit}
            disabled={hasInvalidIzin}
            className={`bg-primary hover:bg-primary/90 text-white px-8 py-3 rounded-2xl font-semibold shadow-lg shadow-primary/20 transition-all active:scale-
              ${hasInvalidIzin ? "bg-muted text-muted-foreground cursor-not-allowed" : "bg-primary hover:bg-primary-dark text-white active:scale-95"}`}
          >
            Simpan Absensi
          </button>
        </div>
      </div>
    </div>
  );
}

--- FILE: ./pages/muhafidz/index.tsx ---

import { Routes, Route, Navigate } from "react-router-dom";
import SetoranPage from "./Setoran";
import AbsensiPage from "./Absensi"; 
import KelolaSantriPage from "./KelolaSantri"; 
import ProgresSantriPage from "./ProgresSantri";

export default function MuhafidzPage() {
  return (
    <Routes>
      {/* Default redirect ke absensi atau setoran */}
      <Route index element={<AbsensiPage />} />
      
      <Route path="/setoran" element={<SetoranPage />} />
      
      <Route path="santri" element={<KelolaSantriPage />} />

      <Route path="progres" element={<ProgresSantriPage />} />
      
      {/* Halaman Riwayat */}
      <Route path="riwayat" element={<div>Halaman Riwayat (Coming Soon)</div>} />

      {/* Fallback */}
      <Route path="*" element={<Navigate to="." replace />} />
    </Routes>
  );
}

--- FILE: ./pages/muhafidz/Setoran.tsx ---

import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { setoranSchema, type SetoranFormValues } from "@/utils/zodSchema";

// UI Components (Shadcn)
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from "@/components/ui/form";

// Mock Data
const MOCK_SANTRI = [
  { id: 1, nama: "Ahmad" },
  { id: 2, nama: "Zaid Ramadhan" },
  { id: 3, nama: "Umar Mukhtar" },
];

const MOCK_HISTORY = [
  { id: 101, nama: "Ahmad", surah: "Al-Baqarah", ayat: "1-10", nilai: 90, waktu: "08:30" },
  { id: 102, nama: "Zaid Ramadhan", surah: "An-Naba", ayat: "1-40", nilai: 85, waktu: "09:15" },
];

export default function InputSetoranPage() {
    const form = useForm<SetoranFormValues>({
    // Gunakan casting 'as any' pada zodResolver jika versi library bentrok
    resolver: zodResolver(setoranSchema) as any, 
    defaultValues: {
        santri_id: 0,
        surah: "",
        ayat_mulai: 1,
        ayat_selesai: 1,
        nilai: 80,
        catatan: "ulang",
        tanggal: new Date(),
    },
    });

  function onSubmit(data: SetoranFormValues) {
    console.log("Submit Data:", data);
    alert("Setoran Berhasil Disimpan!");
    form.reset({
      ...form.getValues(),
      surah: "",
      ayat_mulai: 1,
      ayat_selesai: 1,
    });
  }

  return (
    <div className="space-y-6">
      <div className="flex flex-col text-left">
        <h2 className="text-2xl font-bold tracking-tight text-foreground dark:text-foreground-dark">
          Input Setoran Hafalan
        </h2>
        <p className="text-muted-foreground dark:text-text-secondary-dark">
          Silahkan pilih santri dan masukkan detail hafalan.
        </p>
      </div>

      {/* Card Wrapper */}
      <div className="rounded-xl border border-border dark:border-border-dark bg-card dark:bg-surface-dark p-6 shadow-sm transition-colors">
        <Form {...form}>
          <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-6">
            
            {/* Pilih Santri */}
            <FormField
              control={form.control}
              name="santri_id"
              render={({ field }) => (
                <FormItem className="text-left">
                  <FormLabel className="dark:text-foreground-dark">Santri</FormLabel>
                  <FormControl>
                    <select
                      {...field}
                      value={field.value}
                      onChange={(e) => field.onChange(e.target.value)}
                      className="flex h-10 w-full rounded-md border border-input dark:border-border-dark bg-background dark:bg-background-dark px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring dark:text-foreground-dark"
                    >
                      <option value={0} disabled>-- Pilih Nama Santri --</option>
                      {MOCK_SANTRI.map((s) => (
                        <option key={s.id} value={s.id}>{s.nama}</option>
                      ))}
                    </select>
                  </FormControl>
                  <FormMessage className="text-destructive dark:text-red-400" />
                </FormItem>
              )}
            />

            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 text-left">
              {/* Surah */}
              <FormField
                control={form.control}
                name="surah"
                render={({ field }) => (
                  <FormItem className="md:col-span-2">
                    <FormLabel className="dark:text-foreground-dark">Nama Surah</FormLabel>
                    <FormControl>
                      <Input 
                        placeholder="Contoh: Al-Baqarah" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark dark:text-foreground-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              {/* Ayat Mulai */}
              <FormField
                control={form.control}
                name="ayat_mulai"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="dark:text-foreground-dark">Ayat Mulai</FormLabel>
                    <FormControl>
                      <Input 
                        type="number" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              {/* Ayat Selesai */}
              <FormField
                control={form.control}
                name="ayat_selesai"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="dark:text-foreground-dark">Ayat Selesai</FormLabel>
                    <FormControl>
                      <Input 
                        type="number" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              {/* Nilai */}
              <FormField
                control={form.control}
                name="nilai"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="dark:text-foreground-dark">Nilai</FormLabel>
                    <FormControl>
                      <Input 
                        type="number" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              {/* Catatan */}
              <FormField
                control={form.control}
                name="catatan"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="dark:text-foreground-dark">Catatan</FormLabel>
                    <FormControl>
                      <Input 
                        placeholder="Tambahkan catatan jika ada" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />
            </div>

            <div className="flex justify-end pt-4">
              <Button 
                type="submit" 
                className="w-full md:w-auto bg-primary hover:bg-primary-dark text-primary-foreground px-10"
              >
                Simpan Setoran
              </Button>
            </div>
          </form>
        </Form>
      </div>

      {/* Tabel Riwayat Hari Ini */}
      <div className="space-y-4">
        <div className="flex items-center justify-between">
          <h3 className="text-lg font-semibold dark:text-foreground-dark">Riwayat Setoran Hari Ini</h3>
          <span className="text-xs text-muted-foreground bg-accent/50 dark:bg-surface-dark px-2 py-1 rounded-full border border-border dark:border-border-dark">
            {new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' })}
          </span>
        </div>

        <div className="rounded-xl border border-border dark:border-border-dark bg-card dark:bg-surface-dark overflow-hidden shadow-sm">
          <div className="overflow-x-auto">
            <table className="w-full text-left text-sm">
              <thead className="bg-accent/30 dark:bg-background-dark/50 text-muted-foreground font-medium border-b border-border dark:border-border-dark">
                <tr>
                  <th className="px-6 py-3">Nama Santri</th>
                  <th className="px-6 py-3">Surah</th>
                  <th className="px-6 py-3 text-center">Ayat</th>
                  <th className="px-6 py-3 text-center">Nilai</th>
                  <th className="px-6 py-3 text-right">Waktu</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-border dark:divide-border-dark">
                {MOCK_HISTORY.map((item) => (
                  <tr key={item.id} className="hover:bg-accent/10 dark:hover:bg-background-dark/30 transition-colors">
                    <td className="px-6 py-4 font-medium dark:text-foreground-dark">{item.nama}</td>
                    <td className="px-6 py-4 dark:text-text-secondary-dark">{item.surah}</td>
                    <td className="px-6 py-4 text-center dark:text-text-secondary-dark">{item.ayat}</td>
                    <td className="px-6 py-4 text-center">
                      <span className="inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary border border-primary/20">
                        {item.nilai}
                      </span>
                    </td>
                    <td className="px-6 py-4 text-right text-muted-foreground">{item.waktu}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
          
          {MOCK_HISTORY.length === 0 && (
            <div className="py-10 text-center text-muted-foreground">
              Belum ada setoran masuk hari ini.
            </div>
          )}
        </div>
      </div>
    </div>
  );
}

--- FILE: ./pages/muhafidz/KelolaSantri/index.tsx ---

import { useState, useEffect, useMemo } from "react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faPlus, faSearch, faCheck, faTimes } from "@fortawesome/free-solid-svg-icons";

// Import Komponen Modular
import { SantriStats } from "./SantriStats";
import { SantriTable } from "./SantriTable";
import { SantriInfoCard } from "./SantriInfoCard";
import { SantriSkeleton } from "./SantriSkeleton";
import { SantriModal } from "./SantriModal";

interface Santri {
  id_santri: number;
  nama: string;
  target: "RINGAN" | "SEDANG" | "INTENS" | "CUSTOM_KHUSUS";
  halaqah_id: number;
}

export default function KelolaSantriPage() {
  // --- States ---
  const [santriList, setSantriList] = useState<Santri[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [searchTerm, setSearchTerm] = useState("");
  const [feedback, setFeedback] = useState<{ type: 'success' | 'error', msg: string } | null>(null);
  
  // State untuk Modal (Tambah/Edit)
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [selectedSantri, setSelectedSantri] = useState<Santri | null>(null);

  // --- Load Data ---
  useEffect(() => {
    const loadData = () => {
      setIsLoading(true);
      setTimeout(() => {
        setSantriList([
          { id_santri: 1, nama: "Ahmad Farhan", target: "SEDANG", halaqah_id: 1 },
          { id_santri: 2, nama: "Zaid Ramadhan", target: "INTENS", halaqah_id: 1 },
          { id_santri: 3, nama: "Umar Mukhtar", target: "RINGAN", halaqah_id: 1 },
        ]);
        setIsLoading(false);
      }, 1000);
    };
    loadData();
  }, []);

  // --- Helper Functions ---
  const showFeedback = (type: 'success' | 'error', msg: string) => {
    setFeedback({ type, msg });
    setTimeout(() => setFeedback(null), 3000);
  };

  const filteredSantri = useMemo(() => 
    santriList.filter(s => s.nama.toLowerCase().includes(searchTerm.toLowerCase())),
  [santriList, searchTerm]);

  // --- Handlers ---
  const handleOpenAddModal = () => {
    setSelectedSantri(null);
    setIsModalOpen(true);
  };

  const handleOpenEditModal = (santri: Santri) => {
    setSelectedSantri(santri);
    setIsModalOpen(true);
  };

  const handleSaveSantri = (data: Partial<Santri>) => {
    if (selectedSantri) {
      // Logic Update (Simulasi)
      setSantriList(prev => prev.map(s => 
        s.id_santri === selectedSantri.id_santri ? { ...s, ...data } : s
      ));
      showFeedback('success', `Berhasil memperbarui data ${data.nama}`);
    } else {
      // Logic Create (Simulasi ID)
      const newSantri = { ...data, id_santri: Date.now() } as Santri;
      setSantriList(prev => [...prev, newSantri]);
      showFeedback('success', `Berhasil menambah santri ${data.nama}`);
    }
    setIsModalOpen(false);
  };

  const handleDeleteSantri = (santri: Santri) => {
    if (confirm(`Hapus santri ${santri.nama}?`)) {
      setSantriList(prev => prev.filter(s => s.id_santri !== santri.id_santri));
      showFeedback('success', "Santri berhasil dihapus");
    }
  };

  // --- View Logic ---
  if (isLoading) return <SantriSkeleton />;

  return (
    <div className="space-y-6 container mx-auto py-6 animate-in fade-in duration-500">
      
      {/* 1. Header & Action */}
      <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <div>
          <h2 className="text-2xl font-bold dark:text-white">Kelola Santri</h2>
          <p className="text-muted-foreground text-sm">Kelola data santri di halaqah Anda</p>
        </div>
        <Button onClick={handleOpenAddModal} className="bg-primary">
          <FontAwesomeIcon icon={faPlus} className="mr-2" /> 
          Tambah Santri
        </Button>
      </div>

      {/* 2. Feedback Alert */}
      {feedback && (
        <Alert variant={feedback.type === 'success' ? "default" : "destructive"} 
               className={feedback.type === 'success' ? "bg-green-50 border-green-200 text-green-800" : ""}>
          <FontAwesomeIcon icon={feedback.type === 'success' ? faCheck : faTimes} className="mr-2" />
          <AlertDescription>{feedback.msg}</AlertDescription>
        </Alert>
      )}

      {/* 3. Search Bar */}
      <div className="relative">
        <FontAwesomeIcon icon={faSearch} className="absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground" />
        <Input 
          placeholder="Cari nama santri..." 
          value={searchTerm} 
          onChange={(e) => setSearchTerm(e.target.value)} 
          className="pl-10 h-12" 
        />
      </div>

      {/* 4. Stats Cards */}
      <SantriStats santriList={santriList} />
      
      {/* 5. Main Table (Shadcn) */}
      <SantriTable 
        data={filteredSantri} 
        totalData={santriList.length} 
        searchTerm={searchTerm}
        onEdit={handleOpenEditModal}
        onDelete={handleDeleteSantri}
        onAddClick={handleOpenAddModal}
      />

      {/* 6. Info Card & Footer */}
      <SantriInfoCard />

      {/* 7. Dialog Form (Shadcn) */}
      <SantriModal 
        isOpen={isModalOpen}
        onClose={() => setIsModalOpen(false)}
        onSave={handleSaveSantri}
        editingSantri={selectedSantri}
      />
      
    </div>
  );
}

--- FILE: ./pages/muhafidz/KelolaSantri/SantriStats.tsx ---

import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faUsers, faUserGraduate, faBook } from "@fortawesome/free-solid-svg-icons";

interface Santri {
  id_santri: number;
  nama: string;
  target: "RINGAN" | "SEDANG" | "INTENS" | "CUSTOM_KHUSUS";
  halaqah_id: number;
}

export function SantriStats({ santriList }: { santriList: Santri[] }) {
  const stats = [
    { label: "Total Santri", value: santriList.length, icon: faUsers, color: "text-primary", bg: "bg-primary/10" },
    { label: "Target Ringan", value: santriList.filter(s => s.target === "RINGAN").length, icon: faUserGraduate, color: "text-green-600", bg: "bg-green-100" },
    { label: "Target Sedang", value: santriList.filter(s => s.target === "SEDANG").length, icon: faBook, color: "text-yellow-600", bg: "bg-yellow-100" },
    { label: "Target Khusus", value: santriList.filter(s => s.target === "CUSTOM_KHUSUS").length, icon: faUserGraduate, color: "text-purple-600", bg: "bg-purple-100" },
  ];

  return (
    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
      {stats.map((stat, i) => (
        <div key={i} className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className={`h-10 w-10 rounded-lg ${stat.bg} flex items-center justify-center`}>
              <FontAwesomeIcon icon={stat.icon} className={stat.color} />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">{stat.label}</p>
              <p className="text-2xl font-bold dark:text-white">{stat.value}</p>
            </div>
          </div>
        </div>
      ))}
    </div>
  );
}

--- FILE: ./pages/muhafidz/KelolaSantri/SantriTable.tsx ---

import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table"; // Import shadcn table
import { Button } from "@/components/ui/button";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faUserGraduate, 
  faEdit, 
  faTrash, 
  faUsers, 
  faPlus 
} from "@fortawesome/free-solid-svg-icons";

interface Santri {
  id_santri: number;
  nama: string;
  target: "RINGAN" | "SEDANG" | "INTENS" | "CUSTOM_KHUSUS";
  halaqah_id: number;
}

interface SantriTableProps {
  data: Santri[];
  totalData: number;
  searchTerm: string;
  onEdit: (s: Santri) => void;
  onDelete: (s: Santri) => void;
  onAddClick: () => void;
}

export function SantriTable({ 
  data, 
  totalData, 
  searchTerm, 
  onEdit, 
  onDelete, 
  onAddClick 
}: SantriTableProps) {
  
  const getTargetColor = (target: string) => {
    const colors: Record<string, string> = {
      RINGAN: "bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",
      SEDANG: "bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",
      INTENS: "bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",
      CUSTOM_KHUSUS: "bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",
    };
    return colors[target] || "bg-gray-100 text-gray-700";
  };

  if (data.length === 0) {
    return (
      <div className="p-12 text-center border rounded-xl bg-card">
        <FontAwesomeIcon icon={faUsers} className="text-5xl text-muted-foreground mb-4" />
        <h4 className="font-medium mb-2 dark:text-white">Tidak ada santri</h4>
        <p className="text-text-secondary mb-4">
          {searchTerm ? "Santri tidak ditemukan" : "Mulai dengan menambahkan santri"}
        </p>
        <Button onClick={onAddClick}>
          <FontAwesomeIcon icon={faPlus} className="mr-2" /> 
          Tambah Santri Pertama
        </Button>
      </div>
    );
  }

  return (
    <div className="rounded-xl border bg-card shadow-sm overflow-hidden">
      <div className="p-6 border-b">
        <h3 className="font-semibold text-lg dark:text-white">Daftar Santri</h3>
        <p className="text-sm text-muted-foreground">
          Menampilkan {data.length} dari {totalData} santri
        </p>
      </div>
      
      {/* Menggunakan Shadcn Table */}
      <Table>
        <TableHeader className="bg-muted/50">
          <TableRow>
            <TableHead className="w-[100px] pl-6">ID</TableHead>
            <TableHead>Nama Santri</TableHead>
            <TableHead>Target</TableHead>
            <TableHead className="text-right pr-6">Aksi</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {data.map((santri) => (
            <TableRow key={santri.id_santri} className="group">
              <TableCell className="pl-6 font-medium text-primary">
                #{santri.id_santri}
              </TableCell>
              <TableCell>
                <div className="flex items-center gap-3">
                  <div className="h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center">
                    <FontAwesomeIcon icon={faUserGraduate} className="text-primary text-xs" />
                  </div>
                  <span className="font-medium dark:text-white">{santri.nama}</span>
                </div>
              </TableCell>
              <TableCell>
                <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${getTargetColor(santri.target)}`}>
                  {santri.target.replace('_', ' ')}
                </span>
              </TableCell>
              <TableCell className="text-right pr-6">
                <div className="flex justify-end gap-2">
                  <Button 
                    variant="ghost" 
                    size="sm" 
                    onClick={() => onEdit(santri)}
                    className="h-8 hover:bg-primary/10 hover:text-primary"
                  >
                    <FontAwesomeIcon icon={faEdit} className="mr-2 h-3 w-3" />
                    Edit
                  </Button>
                  <Button 
                    variant="ghost" 
                    size="sm" 
                    onClick={() => onDelete(santri)}
                    className="h-8 hover:bg-destructive/10 hover:text-destructive text-muted-foreground"
                  >
                    <FontAwesomeIcon icon={faTrash} className="mr-2 h-3 w-3" />
                    Hapus
                  </Button>
                </div>
              </TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </div>
  );
}

--- FILE: ./pages/muhafidz/KelolaSantri/SantriInfoCard.tsx ---

import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faBook } from "@fortawesome/free-solid-svg-icons";

export function SantriInfoCard() {
  const targets = [
    { label: "Ringan", desc: "1-2 halaman per pertemuan (untuk pemula)", color: "text-green-500" },
    { label: "Sedang", desc: "3-4 halaman per pertemuan (rata-rata)", color: "text-yellow-500" },
    { label: "Intens", desc: "5-6 halaman per pertemuan (lanjutan)", color: "text-orange-500" },
    { label: "Khusus", desc: "Target khusus sesuai kesepakatan", color: "text-purple-500" },
  ];

  return (
    <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
      <div className="flex items-start gap-3">
        <div className="h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center flex-shrink-0">
          <FontAwesomeIcon icon={faBook} className="text-blue-600 dark:text-blue-400" />
        </div>
        <div>
          <h4 className="font-semibold dark:text-white mb-2">Keterangan Target Hafalan</h4>
          <ul className="text-sm text-text-secondary dark:text-text-secondary-dark space-y-2">
            {targets.map((t, idx) => (
              <li key={idx} className="flex items-start gap-2">
                <span className={`font-bold ${t.color}`}> {t.label}:</span>
                <span>{t.desc}</span>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </div>
  );
}

--- FILE: ./pages/muhafidz/KelolaSantri/SantriSkeleton.tsx ---

import { Skeleton } from "@/components/ui/skeleton";

export function SantriSkeleton() {
  return (
    <div className="space-y-6 animate-in fade-in duration-500">
      <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <div className="space-y-2">
          <Skeleton className="h-8 w-48" />
          <Skeleton className="h-4 w-64" />
        </div>
        <Skeleton className="h-10 w-32" />
      </div>

      <Skeleton className="h-12 w-full" />

      <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
        {[1, 2, 3, 4].map((i) => (
          <Skeleton key={i} className="h-24 rounded-xl" />
        ))}
      </div>

      <div className="space-y-3">
        {[1, 2, 3, 4].map((i) => (
          <Skeleton key={i} className="h-16 w-full rounded-lg" />
        ))}
      </div>
    </div>
  );
}

--- FILE: ./pages/muhafidz/KelolaSantri/SantriModal.tsx ---

import { useEffect, useState } from "react";
import { Button } from "@/components/ui/button";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogFooter,
} from "@/components/ui/dialog";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";

interface Santri {
  id_santri: number;
  nama: string;
  target: "RINGAN" | "SEDANG" | "INTENS" | "CUSTOM_KHUSUS";
  halaqah_id: number;
}

interface SantriModalProps {
  isOpen: boolean;
  onClose: () => void;
  onSave: (data: Partial<Santri>) => void;
  editingSantri?: Santri | null;
}

export function SantriModal({ isOpen, onClose, onSave, editingSantri }: SantriModalProps) {
  const [nama, setNama] = useState("");
  const [target, setTarget] = useState<Santri["target"]>("SEDANG");

  // Reset atau isi form saat modal dibuka
  useEffect(() => {
    if (editingSantri) {
      setNama(editingSantri.nama);
      setTarget(editingSantri.target);
    } else {
      setNama("");
      setTarget("SEDANG");
    }
  }, [editingSantri, isOpen]);

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    onSave({
      nama,
      target,
      halaqah_id: 1, // Default sementara
    });
    onClose();
  };

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-[425px]">
        <form onSubmit={handleSubmit}>
          <DialogHeader>
            <DialogTitle>{editingSantri ? "Edit Data Santri" : "Tambah Santri Baru"}</DialogTitle>
          </DialogHeader>
          
          <div className="grid gap-4 py-4">
            <div className="grid gap-2">
              <Label htmlFor="nama">Nama Lengkap</Label>
              <Input
                id="nama"
                value={nama}
                onChange={(e) => setNama(e.target.value)}
                placeholder="Masukkan nama santri"
                required
              />
            </div>
            <div className="grid gap-2">
              <Label htmlFor="target">Target Hafalan</Label>
              <select
                id="target"
                className="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                value={target}
                onChange={(e) => setTarget(e.target.value as Santri["target"])}
              >
                <option value="RINGAN">Ringan (1-2 Halaman)</option>
                <option value="SEDANG">Sedang (3-4 Halaman)</option>
                <option value="INTENS">Intens (5-6 Halaman)</option>
                <option value="CUSTOM_KHUSUS">Khusus</option>
              </select>
            </div>
          </div>

          <DialogFooter>
            <Button type="button" variant="outline" onClick={onClose}>
              Batal
            </Button>
            <Button type="submit" className="bg-primary">
              Simpan Data
            </Button>
          </DialogFooter>
        </form>
      </DialogContent>
    </Dialog>
  );
}

--- FILE: ./pages/muhafidz/ProgresSantri/index.tsx ---

import { useState } from "react";
import { Button } from "@/components/ui/button";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faChartLine, 
  faCalendarAlt,
  faUserGraduate,
  faCheckCircle,
  faClock,
  faBookOpen
} from "@fortawesome/free-solid-svg-icons";

// Data dummy untuk progres santri
const dummyProgres = [
  { 
    id: 1, 
    nama: "Ahmad Farhan", 
    target: "SEDANG", 
    capaian: 75, 
    status: "On Track",
    terakhirSetor: "2 hari lalu",
    totalAyat: 150
  },
  { 
    id: 2, 
    nama: "Zaid Ramadhan", 
    target: "INTENS", 
    capaian: 90, 
    status: "Excellent",
    terakhirSetor: "Kemarin",
    totalAyat: 280
  },
  { 
    id: 3, 
    nama: "Umar Mukhtar", 
    target: "RINGAN", 
    capaian: 60, 
    status: "Perlu Bimbingan",
    terakhirSetor: "3 hari lalu",
    totalAyat: 85
  },
  { 
    id: 4, 
    nama: "Abdullah Haikal", 
    target: "CUSTOM_KHUSUS", 
    capaian: 85, 
    status: "On Track",
    terakhirSetor: "Kemarin",
    totalAyat: 120
  },
];

export default function ProgresSantriPage() {
  const [filterStatus, setFilterStatus] = useState("semua");
  const [filterTarget, setFilterTarget] = useState("semua");

  // Filter progres berdasarkan status dan target
  const filteredProgres = dummyProgres.filter(progres => {
    const statusMatch = filterStatus === "semua" || progres.status === filterStatus;
    const targetMatch = filterTarget === "semua" || progres.target === filterTarget;
    return statusMatch && targetMatch;
  });

  // Warna berdasarkan status
  const getStatusColor = (status: string) => {
    switch (status) {
      case "Excellent": return "text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-300";
      case "On Track": return "text-blue-600 bg-blue-100 dark:bg-blue-900/30 dark:text-blue-300";
      case "Perlu Bimbingan": return "text-orange-600 bg-orange-100 dark:bg-orange-900/30 dark:text-orange-300";
      default: return "text-gray-600 bg-gray-100 dark:bg-gray-900/30 dark:text-gray-300";
    }
  };

  // Warna bar progres
  const getProgresColor = (capaian: number) => {
    if (capaian >= 80) return "bg-green-500";
    if (capaian >= 60) return "bg-blue-500";
    return "bg-orange-500";
  };

  return (
    <div className="space-y-6 animate-in fade-in duration-500">
      {/* Header */}
      <div className="flex flex-col text-left">
        <h2 className="text-2xl font-bold dark:text-white">Progres Santri</h2>
        <p className="text-text-secondary dark:text-text-secondary-dark text-sm">
          Pantau perkembangan hafalan santri
        </p>
      </div>

      {/* Filter Options */}
      <div className="flex flex-col md:flex-row gap-4">
        <div className="flex-1">
          <label className="block text-sm font-medium mb-2 dark:text-white">Filter Status</label>
          <Select value={filterStatus} onValueChange={setFilterStatus}>
            <SelectTrigger className="w-full">
              <SelectValue placeholder="Pilih status" />
            </SelectTrigger>
            <SelectContent>
              <SelectItem value="semua">Semua Status</SelectItem>
              <SelectItem value="Excellent">Excellent</SelectItem>
              <SelectItem value="On Track">On Track</SelectItem>
              <SelectItem value="Perlu Bimbingan">Perlu Bimbingan</SelectItem>
            </SelectContent>
          </Select>
        </div>

        <div className="flex-1">
          <label className="block text-sm font-medium mb-2 dark:text-white">Filter Target</label>
          <Select value={filterTarget} onValueChange={setFilterTarget}>
            <SelectTrigger className="w-full">
              <SelectValue placeholder="Pilih target" />
            </SelectTrigger>
            <SelectContent>
              <SelectItem value="semua">Semua Target</SelectItem>
              <SelectItem value="RINGAN">Ringan</SelectItem>
              <SelectItem value="SEDANG">Sedang</SelectItem>
              <SelectItem value="INTENS">Intens</SelectItem>
              <SelectItem value="CUSTOM_KHUSUS">Khusus</SelectItem>
            </SelectContent>
          </Select>
        </div>

        <div className="flex items-end">
          <Button variant="outline" className="w-full md:w-auto">
            <FontAwesomeIcon icon={faCalendarAlt} className="mr-2" />
            Bulan Ini
          </Button>
        </div>
      </div>

      {/* Stats Summary */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-green-100 dark:bg-green-900/20 flex items-center justify-center">
              <FontAwesomeIcon icon={faCheckCircle} className="text-green-600 dark:text-green-400" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Rata-rata Capaian</p>
              <p className="text-2xl font-bold dark:text-white">77.5%</p>
            </div>
          </div>
        </div>

        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center">
              <FontAwesomeIcon icon={faBookOpen} className="text-blue-600 dark:text-blue-400" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Total Ayat</p>
              <p className="text-2xl font-bold dark:text-white">635</p>
            </div>
          </div>
        </div>

        <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-lg bg-purple-100 dark:bg-purple-900/20 flex items-center justify-center">
              <FontAwesomeIcon icon={faUserGraduate} className="text-purple-600 dark:text-purple-400" />
            </div>
            <div>
              <p className="text-sm text-text-secondary dark:text-text-secondary-dark">Santri Aktif</p>
              <p className="text-2xl font-bold dark:text-white">{dummyProgres.length}</p>
            </div>
          </div>
        </div>
      </div>

      {/* Tabel Progres */}
      <div className="rounded-xl border border-border bg-card dark:bg-surface-dark shadow-sm overflow-hidden">
        <div className="p-6 border-b border-border dark:border-border-dark">
          <h3 className="font-semibold text-lg dark:text-white">Detail Progres Santri</h3>
          <p className="text-sm text-text-secondary dark:text-text-secondary-dark">
            Menampilkan {filteredProgres.length} dari {dummyProgres.length} santri
          </p>
        </div>

        {filteredProgres.length === 0 ? (
          <div className="p-12 text-center">
            <FontAwesomeIcon icon={faChartLine} className="text-5xl text-text-secondary-light dark:text-text-secondary-dark mb-4" />
            <h4 className="font-medium dark:text-white mb-2">Tidak ada data</h4>
            <p className="text-text-secondary dark:text-text-secondary-dark">
              Tidak ada progres yang sesuai dengan filter
            </p>
          </div>
        ) : (
          <div className="overflow-x-auto">
            <table className="w-full">
              <thead className="bg-accent/30 dark:bg-background-dark/50 text-muted-foreground font-medium">
                <tr>
                  <th className="px-6 py-4 text-left">Nama Santri</th>
                  <th className="px-6 py-4 text-left">Target</th>
                  <th className="px-6 py-4 text-left">Progres</th>
                  <th className="px-6 py-4 text-left">Status</th>
                  <th className="px-6 py-4 text-left">Terakhir Setor</th>
                  <th className="px-6 py-4 text-left">Total Ayat</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-border dark:divide-border-dark">
                {filteredProgres.map((progres) => (
                  <tr 
                    key={progres.id} 
                    className="hover:bg-accent/5 dark:hover:bg-background-dark/30 transition-colors"
                  >
                    <td className="px-6 py-4">
                      <div className="flex items-center gap-2">
                        <div className="h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center">
                          <FontAwesomeIcon icon={faUserGraduate} className="text-primary text-sm" />
                        </div>
                        <span className="font-medium dark:text-white">{progres.nama}</span>
                      </div>
                    </td>
                    <td className="px-6 py-4">
                      <span className="inline-flex items-center rounded-full bg-gray-100 dark:bg-gray-900/30 px-3 py-1 text-xs font-medium text-gray-700 dark:text-gray-300">
                        {progres.target}
                      </span>
                    </td>
                    <td className="px-6 py-4">
                      <div className="space-y-1">
                        <div className="flex justify-between text-sm">
                          <span>{progres.capaian}%</span>
                          <span>{progres.totalAyat} ayat</span>
                        </div>
                        <div className="h-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                          <div 
                            className={`h-full rounded-full ${getProgresColor(progres.capaian)}`}
                            style={{ width: `${progres.capaian}%` }}
                          />
                        </div>
                      </div>
                    </td>
                    <td className="px-6 py-4">
                      <span className={`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${getStatusColor(progres.status)}`}>
                        {progres.status}
                      </span>
                    </td>
                    <td className="px-6 py-4">
                      <div className="flex items-center gap-2 text-sm text-text-secondary dark:text-text-secondary-dark">
                        <FontAwesomeIcon icon={faClock} className="text-sm" />
                        {progres.terakhirSetor}
                      </div>
                    </td>
                    <td className="px-6 py-4">
                      <span className="font-medium dark:text-white">{progres.totalAyat}</span>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        )}
      </div>

      {/* Legend Keterangan */}
      <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm">
        <h4 className="font-semibold dark:text-white mb-3">Keterangan Status</h4>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
          <div className="flex items-center gap-2">
            <div className="h-3 w-3 rounded-full bg-green-500" />
            <span className="text-sm dark:text-white">Excellent (80%)</span>
          </div>
          <div className="flex items-center gap-2">
            <div className="h-3 w-3 rounded-full bg-blue-500" />
            <span className="text-sm dark:text-white">On Track (60-79%)</span>
          </div>
          <div className="flex items-center gap-2">
            <div className="h-3 w-3 rounded-full bg-orange-500" />
            <span className="text-sm dark:text-white">Perlu Bimbingan (60%)</span>
          </div>
        </div>
      </div>
    </div>
  );
}

--- FILE: ./context/AuthContext.tsx ---

import React, { createContext, useContext, useState, useEffect, useCallback } from "react";
import { type LoginFormValues } from "@/utils/zodSchema";
import { authService } from "@/services/authService";

export type Role = "superadmin" | "muhafiz";

interface User {
  id_user: number;
  email: string;
  role: Role;
  username: string;
  token?: string;
  avatarUrl?: string;
}

interface AuthContextType {
  user: User | null;
  login: (values: LoginFormValues) => Promise<void>;
  logout: () => void;
  isLoading: boolean;
  isDarkMode: boolean;
  toggleDarkMode: () => void;
  refreshUser: () => Promise<void>;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export const AuthProvider = ({ children }: { children: React.ReactNode }) => {
  const [user, setUser] = useState<User | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [isDarkMode, setIsDarkMode] = useState(false);

  const initializeTheme = () => {
    const savedTheme = localStorage.getItem("theme");
    const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
    const shouldBeDark = savedTheme === "dark" || (!savedTheme && prefersDark);
    
    setIsDarkMode(shouldBeDark);
    if (shouldBeDark) {
      document.documentElement.classList.add("dark");
    }
  };

  const refreshUser = useCallback(async () => {
    const savedData = localStorage.getItem("user");
    
    if (!savedData) {
      setIsLoading(false);
      return;
    }

    try {
      // Parse data dari localStorage untuk cek token
      const parsedData = JSON.parse(savedData);
      if (!parsedData.token) {
        logout();
        return;
      }

      // Coba ambil data user dari endpoint /auth/me
      try {
        const response = await authService.getCurrentUser();
        const userData = response.data.user;
        
        // Gabungkan dengan token dari localStorage
        const fullUser: User = {
          ...userData,
          token: parsedData.token,
          username: userData.username || "User"
        };

        setUser(fullUser);
        localStorage.setItem("user", JSON.stringify(fullUser));
      } catch (error) {
        console.error("Failed to fetch user from API:", error);
        // Jika gagal fetch user, tetap set user dari localStorage
        setUser(parsedData);
      }
    } catch (error) {
      console.error("Failed to parse user data:", error);
      logout();
    } finally {
      setIsLoading(false);
    }
  }, []);

  const login = async (values: LoginFormValues) => {
    setIsLoading(true);
    try {
      const response = await authService.login(values);
      
      const userData: User = {
        ...response.data.user,
        token: response.data.token,
        username: response.data.user.username || "User"
      };

      setUser(userData);
      localStorage.setItem("user", JSON.stringify(userData));
    } catch (error) {
      throw error;
    } finally {
      setIsLoading(false);
    }
  };
  
  const logout = () => {
    setUser(null);
    setIsLoading(false);
    localStorage.removeItem("user");
  };

  const toggleDarkMode = () => {
    const newDarkMode = !isDarkMode;
    setIsDarkMode(newDarkMode);
    if (newDarkMode) {
      document.documentElement.classList.add("dark");
      localStorage.setItem("theme", "dark");
    } else {
      document.documentElement.classList.remove("dark");
      localStorage.setItem("theme", "light");
    }
  };

  useEffect(() => {
    initializeTheme();
    refreshUser();
  }, []); 

  return (
    <AuthContext.Provider value={{ 
      user, 
      login, 
      logout, 
      isLoading,
      isDarkMode,
      toggleDarkMode,
      refreshUser
    }}>
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => {
  const context = useContext(AuthContext);
  if (!context) throw new Error("useAuth must be used within AuthProvider");
  return context;
};

--- FILE: ./lib/utils.ts ---

import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}


--- FILE: ./routes/index.tsx ---

// FILE: ./routes/index.tsx
import { Routes, Route, Navigate, Outlet } from "react-router-dom";
import LoginPage from "@/pages/auth/LoginPage";
import KepalaMuhafidzDashboard from "@/pages/kepala-muhafidz/Dashboard";
import MuhafidzPage from "@/pages/muhafidz"; 
import { useAuth } from "@/context/AuthContext";
import DashboardLayout from "@/layouts/DashboardLayout";
import { Spinner } from "@/components/ui/spinner";
import KelolaMuhafizPage from "@/pages/kepala-muhafidz/KelolaMuhafiz";
import KelolaHalaqahPage from "@/pages/kepala-muhafidz/KelolaHalaqah";

const ProtectedRoute = ({ allowedRoles }: { allowedRoles?: ("superadmin" | "muhafiz")[] }) => {
  const { user, isLoading } = useAuth();

  if (isLoading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <Spinner className="w-8 h-8" />
      </div>
    );
  }

  // Jika tidak ada user (atau token habis), tendang ke login
  if (!user) {
    return <Navigate to="/login" replace />;
  }

  // Jika role tidak diizinkan, kembalikan ke dashboard sesuai role
  if (allowedRoles && !allowedRoles.includes(user.role)) {
    return user.role === "superadmin" 
      ? <Navigate to="/kepala-muhafidz" replace />
      : <Navigate to="/muhafidz" replace />;
  }

  return <Outlet />;
};

export const AppRouter = () => {
  const { user, isLoading } = useAuth();

  if (isLoading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <Spinner className="w-8 h-8" />
      </div>
    );
  }

  return (
    <Routes>
      {/*  Public Route: Login */}
      <Route 
        path="/login" 
        element={user ? <Navigate to="/" replace /> : <LoginPage />} 
      />

      {/*  Protected Routes: Membutuhkan Login */}
      <Route element={<ProtectedRoute />}>
        <Route element={<DashboardLayout />}>
          
          {/* Redirect berdasarkan role */}
          <Route
            index
            element={
              user?.role === "superadmin" ? (
                <Navigate to="/kepala-muhafidz" replace />
              ) : (
                <Navigate to="/muhafidz" replace />
              )
            }
          />

          {/* Rute Khusus Superadmin (Kepala Muhafidz) */}
          <Route element={<ProtectedRoute allowedRoles={["superadmin"]} />}>
            <Route path="/kepala-muhafidz" element={<KepalaMuhafidzDashboard />} />
            <Route path="/kepala-muhafidz/muhafiz" element={<KelolaMuhafizPage />} />
            <Route path="/kepala-muhafidz/halaqah" element={<KelolaHalaqahPage />} />
            {/* Tambahkan route superadmin lainnya di sini */}
            <Route path="/kepala-muhafidz/*" element={<div>Sub-routes for superadmin</div>} />
          </Route>

          {/* Rute Khusus Muhafidz */}
          <Route element={<ProtectedRoute allowedRoles={["muhafiz"]} />}>
            <Route path="/muhafidz/*" element={<MuhafidzPage />} />
          </Route>

        </Route>
      </Route>

      {/* 404 Fallback */}
      <Route path="*" element={<Navigate to="/" replace />} />
    </Routes>
  );
};

--- FILE: ./utils/zodSchema.ts ---

import * as z from "zod";

export const loginSchema = z.object({
  email: z.string().email("Format email tidak valid"),
  password: z.string().min(8, "Password minimal 8 karakter"),
});

export const setoranSchema = z.object({
  santri_id: z.coerce.number().min(1, "Pilih santri"),
  tanggal: z.date(),
  surah: z.string().min(1, "Nama surah wajib diisi"),
  ayat_mulai: z.coerce.number().min(1, "Minimal ayat 1"),
  ayat_selesai: z.coerce.number().min(1, "Minimal ayat 1"),
  nilai: z.coerce.number().min(0).max(100),
  catatan: z.string().default(""), 
});

export const registerSchema = z.object({
  email: z.string().email("Format email tidak valid"),
  username: z.string().min(3, "Username minimal 3 karakter"),
  password: z.string().min(8, "Password minimal 8 karakter"),
  confirmPassword: z.string()
}).refine((data) => data.password === data.confirmPassword, {
  message: "Password tidak cocok",
  path: ["confirmPassword"]
});

export type LoginFormValues = z.infer<typeof loginSchema>;
export type SetoranFormValues = z.infer<typeof setoranSchema>;
export type RegisterFormValues = z.infer<typeof registerSchema>;

--- FILE: ./assets/api.md ---

##  Dokumentasi API Halaqah ID - Update Day 3

Berikut adalah dokumentasi teknis fitur **RBAC (Role-Based Access Control)**, **Username Identity**, dan **Manajemen Akun Muhafiz** yang telah aktif di `main` branch.

###  Ringkasan Sistem

Sistem menggunakan **JWT Authentication** dengan pembagian role yang ketat.

* **Base URL:** `https://halaqahid-backend.vercel.app`
* **Prefix:** `/api/halaqah`

---

###  Keamanan (Middleware)

Setiap request ke endpoint bertanda  wajib menyertakan header:
`Authorization: Bearer <your_jwt_token>`

---

###  Endpoint Authentication

#### 1. Login (Public)

Digunakan untuk mendapatkan token. Sekarang mendukung login via **Email**.

* **URL:** `POST /auth/login`
* **Body:**

```json
{
  "email": "admin@mail.com",
  "password": "admin123"
}

```

#### 2. Get Profile (`/me`) 

Mendapatkan data user yang sedang login dari token.

* **URL:** `GET /auth/me`
* **Akses:** Semua Role (Superadmin & Muhafiz)

---

###  Manajemen User (Admin Only )

#### 1. Register Muhafiz

Membuat akun Muhafiz baru dengan identitas **Username**.

* **URL:** `POST /auth/register`
* **Body:**

```json
{
  "username": "muhafiz_kece",
  "email": "muhafiz@mail.com",
  "password": "password123"
}

```

#### 2. Get All Muhafiz List

Mengambil semua daftar Muhafiz yang aktif (tidak terhapus).

* **URL:** `GET /auth/muhafiz`
* **Akses:** Superadmin Saja.

#### 3. Update Muhafiz (Partial Update)

Mengubah data Muhafiz (Username/Email) secara spesifik.

* **URL:** `PATCH /auth/muhafiz/:id`
* **Body (Opsional):**

```json
{
  "username": "username_baru"
}

```

#### 4. Delete Muhafiz (Soft Delete)

Menghapus akun Muhafiz secara halus (data tetap ada di DB tapi tidak muncul di aplikasi).

* **URL:** `DELETE /auth/muhafiz/:id`

---

###  Tabel Response Error

| HTTP Status | Pesan Error | Penjelasan |
| --- | --- | --- |
| **401** | `Akses ditolak, token tidak ada` | Token tidak valid atau tidak dikirim. |
| **403** | `Akses ditolak: Role muhafiz tidak diizinkan` | User login sebagai muhafiz mencoba akses fitur admin. |
| **400** | `Email sudah terdaftar` | Email sudah ada di database. |
| **400** | `Username sudah digunakan` | Username sudah dipakai oleh user lain. |
| **404** | `Muhafiz tidak ditemukan` | ID user tidak ada atau user tersebut bukan role muhafiz. |

---

###  Catatan Implementasi Frontend

1. **Username Display:** Menampilkan `username` di dashboard sebagai identitas utama.
2. **PATCH Method:** Gunakan `PATCH` untuk edit profil agar hanya mengirim field yang berubah.
3. **Soft Delete Handling:** User yang sudah dihapus akan hilang dari list `GET /muhafiz`.
4. **Validation Error:** Jika dapet status `400` dengan pesan "Username sudah digunakan", beri peringatan pada input username di UI.

---

**Status:**  **Production Ready (Main Branch)**

--- FILE: ./api/axiosClient.ts ---

import axios from "axios";

const axiosClient = axios.create({
  baseURL: import.meta.env.VITE_API_URL || "https://halaqahid-backend.vercel.app/api/halaqah",
  headers: {
    "Content-Type": "application/json",
  },
  timeout: 10000, 
});

// REQUEST INTERCEPTOR
axiosClient.interceptors.request.use((config) => {
  const savedData = localStorage.getItem("user");
  if (savedData) {
    try {
      const { token } = JSON.parse(savedData);
      if (token) {
        config.headers.Authorization = `Bearer ${token}`;
      }
    } catch (e) {
      console.error("Gagal parse data user dari localStorage", e);
    }
  }
  return config;
});

// RESPONSE INTERCEPTOR
axiosClient.interceptors.response.use(
  (response) => response,
  (error) => {
    const originalRequest = error.config;
    const isLoginRequest = error.config?.url?.includes('/login');
    
    // Handle 401 Unauthorized
    if (error.response?.status === 401 && !isLoginRequest && !originalRequest._retry) {
      // Tandai request sudah di-retry
      originalRequest._retry = true;
      
      // Coba refresh token jika ada mekanisme refresh token
      // Untuk sekarang, cukup logout jika 401
      if (localStorage.getItem("user")) {
        localStorage.removeItem("user");
        window.location.href = "/login";
      }
    }
    
    // Log error untuk debugging
    console.error("API Error:", {
      status: error.response?.status,
      data: error.response?.data,
      url: error.config?.url,
      method: error.config?.method
    });
    
    return Promise.reject(error);
  }
);

export default axiosClient;

--- FILE: ./hooks/useAkun.ts ---



--- FILE: ./index.css ---

@import "tailwindcss";
@import "tw-animate-css";

/* Theme Variables */
:root {
  --background: oklch(0.9711 0.0074 80.7211);
  --foreground: oklch(0.3000 0.0358 30.2042);
  --card: oklch(0.9711 0.0074 80.7211);
  --card-foreground: oklch(0.3000 0.0358 30.2042);
  --popover: oklch(0.9711 0.0074 80.7211);
  --popover-foreground: oklch(0.3000 0.0358 30.2042);
  --primary: oklch(0.5234 0.1347 144.1672);
  --primary-foreground: oklch(1.0000 0 0);
  --secondary: oklch(0.9571 0.0210 147.6360);
  --secondary-foreground: oklch(0.4254 0.1159 144.3078);
  --muted: oklch(0.9370 0.0142 74.4218);
  --muted-foreground: oklch(0.4495 0.0486 39.2110);
  --accent: oklch(0.8952 0.0504 146.0366);
  --accent-foreground: oklch(0.4254 0.1159 144.3078);
  --destructive: oklch(0.5386 0.1937 26.7249);
  --destructive-foreground: oklch(1.0000 0 0);
  --border: oklch(0.8805 0.0208 74.6428);
  --input: oklch(0.8805 0.0208 74.6428);
  --ring: oklch(0.5234 0.1347 144.1672);
  --chart-1: oklch(0.6731 0.1624 144.2083);
  --chart-2: oklch(0.5752 0.1446 144.1813);
  --chart-3: oklch(0.5234 0.1347 144.1672);
  --chart-4: oklch(0.4254 0.1159 144.3078);
  --chart-5: oklch(0.2157 0.0453 145.7256);
  --sidebar: oklch(0.9370 0.0142 74.4218);
  --sidebar-foreground: oklch(0.3000 0.0358 30.2042);
  --sidebar-primary: oklch(0.5234 0.1347 144.1672);
  --sidebar-primary-foreground: oklch(1.0000 0 0);
  --sidebar-accent: oklch(0.8952 0.0504 146.0366);
  --sidebar-accent-foreground: oklch(0.4254 0.1159 144.3078);
  --sidebar-border: oklch(0.8805 0.0208 74.6428);
  --sidebar-ring: oklch(0.5234 0.1347 144.1672);
  --font-sans: Montserrat, sans-serif;
  --font-serif: Merriweather, serif;
  --font-mono: Source Code Pro, monospace;
  --radius: 0.5rem;
  --shadow-x: 0;
  --shadow-y: 1px;
  --shadow-blur: 3px;
  --shadow-spread: 0px;
  --shadow-opacity: 0.1;
  --shadow-color: oklch(0 0 0);
  --shadow-2xs: 0 1px 3px 0px hsl(0 0% 0% / 0.05);
  --shadow-xs: 0 1px 3px 0px hsl(0 0% 0% / 0.05);
  --shadow-sm: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 1px 2px -1px hsl(0 0% 0% / 0.10);
  --shadow: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 1px 2px -1px hsl(0 0% 0% / 0.10);
  --shadow-md: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 2px 4px -1px hsl(0 0% 0% / 0.10);
  --shadow-lg: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 4px 6px -1px hsl(0 0% 0% / 0.10);
  --shadow-xl: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 8px 10px -1px hsl(0 0% 0% / 0.10);
  --shadow-2xl: 0 1px 3px 0px hsl(0 0% 0% / 0.25);
  --tracking-normal: 0em;
  --spacing: 0.25rem;
}

.dark {
  --background: oklch(0.2683 0.0279 150.7681);
  --foreground: oklch(0.9423 0.0097 72.6595);
  --card: oklch(0.3327 0.0271 146.9867);
  --card-foreground: oklch(0.9423 0.0097 72.6595);
  --popover: oklch(0.3327 0.0271 146.9867);
  --popover-foreground: oklch(0.9423 0.0097 72.6595);
  --primary: oklch(0.6731 0.1624 144.2083);
  --primary-foreground: oklch(0.2157 0.0453 145.7256);
  --secondary: oklch(0.3942 0.0265 142.9926);
  --secondary-foreground: oklch(0.8970 0.0166 142.5518);
  --muted: oklch(0.2926 0.0212 147.7496);
  --muted-foreground: oklch(0.8579 0.0174 76.0955);
  --accent: oklch(0.5752 0.1446 144.1813);
  --accent-foreground: oklch(0.9423 0.0097 72.6595);
  --destructive: oklch(0.5386 0.1937 26.7249);
  --destructive-foreground: oklch(0.9423 0.0097 72.6595);
  --border: oklch(0.3942 0.0265 142.9926);
  --input: oklch(0.3942 0.0265 142.9926);
  --ring: oklch(0.6731 0.1624 144.2083);
  --chart-1: oklch(0.7660 0.1179 145.2950);
  --chart-2: oklch(0.7185 0.1417 144.8887);
  --chart-3: oklch(0.6731 0.1624 144.2083);
  --chart-4: oklch(0.6291 0.1543 144.2031);
  --chart-5: oklch(0.5752 0.1446 144.1813);
  --sidebar: oklch(0.2683 0.0279 150.7681);
  --sidebar-foreground: oklch(0.9423 0.0097 72.6595);
  --sidebar-primary: oklch(0.6731 0.1624 144.2083);
  --sidebar-primary-foreground: oklch(0.2157 0.0453 145.7256);
  --sidebar-accent: oklch(0.5752 0.1446 144.1813);
  --sidebar-accent-foreground: oklch(0.9423 0.0097 72.6595);
  --sidebar-border: oklch(0.3942 0.0265 142.9926);
  --sidebar-ring: oklch(0.6731 0.1624 144.2083);
  --font-sans: Montserrat, sans-serif;
  --font-serif: Merriweather, serif;
  --font-mono: Source Code Pro, monospace;
  --radius: 0.5rem;
  --shadow-x: 0;
  --shadow-y: 1px;
  --shadow-blur: 3px;
  --shadow-spread: 0px;
  --shadow-opacity: 0.1;
  --shadow-color: oklch(0 0 0);
  --shadow-2xs: 0 1px 3px 0px hsl(0 0% 0% / 0.05);
  --shadow-xs: 0 1px 3px 0px hsl(0 0% 0% / 0.05);
  --shadow-sm: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 1px 2px -1px hsl(0 0% 0% / 0.10);
  --shadow: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 1px 2px -1px hsl(0 0% 0% / 0.10);
  --shadow-md: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 2px 4px -1px hsl(0 0% 0% / 0.10);
  --shadow-lg: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 4px 6px -1px hsl(0 0% 0% / 0.10);
  --shadow-xl: 0 1px 3px 0px hsl(0 0% 0% / 0.10), 0 8px 10px -1px hsl(0 0% 0% / 0.10);
  --shadow-2xl: 0 1px 3px 0px hsl(0 0% 0% / 0.25);
}

/* Theme Configuration */
@theme {
  /* Color Mapping */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  /* Fonts */
  --font-sans: var(--font-sans), ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  --font-mono: var(--font-mono), ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  --font-serif: var(--font-serif), ui-serif, Georgia, Cambria, 'Times New Roman', Times, serif;
  --font-display: var(--font-sans); /* Untuk kompatibilitas dengan kode sebelumnya */

  /* Border Radius */
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);

  /* Shadows */
  --shadow-2xs: var(--shadow-2xs);
  --shadow-xs: var(--shadow-xs);
  --shadow-sm: var(--shadow-sm);
  --shadow: var(--shadow);
  --shadow-md: var(--shadow-md);
  --shadow-lg: var(--shadow-lg);
  --shadow-xl: var(--shadow-xl);
  --shadow-2xl: var(--shadow-2xl);
}

/* Custom Variant untuk Dark Mode */
@custom-variant dark (&:is(.dark *));

/* Base Styles */
@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  
  body {
    @apply bg-background text-foreground font-sans;
    font-feature-settings: "rlig" 1, "calt" 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  html {
    scroll-behavior: smooth;
  }
  
  /* Selection color */
  ::selection {
    @apply bg-primary/20 text-foreground;
  }
  
  /* Scrollbar styling */
  ::-webkit-scrollbar {
    @apply w-2;
  }
  
  ::-webkit-scrollbar-track {
    @apply bg-muted;
  }
  
  ::-webkit-scrollbar-thumb {
    @apply bg-border rounded-full;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    @apply bg-muted-foreground/30;
  }
}

/* Utility Classes */
@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
  
  .glass {
    @apply backdrop-blur-sm bg-white/10 dark:bg-black/10 border border-white/20 dark:border-white/10;
  }
  
  .animate-in {
    animation: animate-in 0.5s ease-out;
  }
  
  .fade-in {
    animation: fade-in 0.5s ease-out;
  }
  
  .slide-in-from-top {
    animation: slide-in-from-top 0.3s ease-out;
  }
  
  .slide-in-from-bottom {
    animation: slide-in-from-bottom 0.3s ease-out;
  }
}

/* Font Import */
@import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap');

/* Animations */
@keyframes animate-in {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slide-in-from-top {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slide-in-from-bottom {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

--- FILE: ./layouts/DashboardLayout.tsx ---

import { useState } from "react";
import { Sidebar } from "@/components/shared/Sidebar";
import { ThemeToggle } from "@/components/ThemeToggle";
import { useAuth } from "@/context/AuthContext";
import { Outlet } from "react-router-dom"; 
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faBars, faTimes } from "@fortawesome/free-solid-svg-icons";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";

export default function DashboardLayout() {
  const { user } = useAuth();
  const [isSidebarOpen, setIsSidebarOpen] = useState(false);

  const toggleSidebar = () => setIsSidebarOpen(!isSidebarOpen);

  return (
    <div className="flex min-h-screen bg-background dark:bg-background-dark font-display relative">
      
      {/* Sidebar - Desktop & Mobile */}
      {/* Overlay untuk mobile saat sidebar terbuka */}
      {isSidebarOpen && (
        <div 
          className="fixed inset-0 z-40 bg-black/50 lg:hidden transition-opacity"
          onClick={() => setIsSidebarOpen(false)}
        />
      )}

      <div className={cn(
        "fixed inset-y-0 left-0 z-50 transform lg:relative lg:translate-x-0 transition duration-300 ease-in-out lg:block",
        isSidebarOpen ? "translate-x-0" : "-translate-x-full"
      )}>
        <Sidebar onClose={() => setIsSidebarOpen(false)} />
      </div>

      <div className="flex flex-1 flex-col min-w-0 overflow-hidden">
        {/* Top Navbar */}
        <header className="
            fixed top-0 left-0 right-0 z-40
            lg:static
            flex h-16 items-center justify-between
            border-b border-border
            bg-surface-light px-4 lg:px-8
            dark:bg-surface-dark
          "> 

          <div className="flex items-center gap-4">
            {/* Hamburger Button - Hanya muncul di mobile */}
            <Button 
              variant="outline" 
              size="icon"
              onClick={toggleSidebar}
              className="lg:hidden" // Sembunyikan di layar besar
            >
              <FontAwesomeIcon icon={isSidebarOpen ? faTimes : faBars} />
            </Button>

            <div className="flex flex-col text-left">
              <h1 className="text-sm font-semibold dark:text-white leading-tight">Selamat Datang,</h1>
              <p className="text-xs text-text-secondary dark:text-text-secondary-dark">{user?.username}</p>
            </div>
          </div>

          <div className="flex items-center gap-4">
            <ThemeToggle variant="simple" />
            <Avatar className="h-9 w-9 border border-primary/20">
              <AvatarImage src={user?.avatarUrl} alt={user?.username} />
              <AvatarFallback className="bg-primary/10 text-primary text-xs font-bold uppercase">
                {user?.username?.substring(0, 2)}
              </AvatarFallback>
            </Avatar>
          </div>
        </header>

        {/* Dynamic Page Content */}
        <main className="flex-1 overflow-y-auto p-4 lg:p-8 pt-20 lg:pt-4 text-left">
          <div className="mx-auto max-w-7xl">
            <Outlet /> 
          </div>
        </main>
      </div>
    </div>
  );
}

--- FILE: ./services/authService.ts ---

import axiosClient from "@/api/axiosClient";
import { type LoginFormValues } from "@/utils/zodSchema";

// Interface respons dari backend (disesuaikan dengan skema Prisma)
export interface AuthResponse {
  success: boolean;
  message: string;
  data: { 
    user: {
      id_user: number;
      email: string;
      username: string;
      role: "superadmin" | "muhafiz";
    };
    token: string;
  };
}

export const authService = {
  login: async (credentials: LoginFormValues): Promise<AuthResponse> => {
    // Endpoint: /auth/login
    const response = await axiosClient.post<AuthResponse>("/auth/login", credentials);
    return response.data;
  },

  getCurrentUser: async (): Promise<AuthResponse> => {
    // Endpoint: /auth/me
    const response = await axiosClient.get<AuthResponse>("/auth/me");
    return response.data;
  },

  logout: () => {
    localStorage.removeItem("user");
  }
};

--- FILE: ./services/akunService.ts ---

import axiosClient from "@/api/axiosClient";

export interface Muhafiz {
  id_user: number;
  email: string;
  username: string;
  role: "muhafiz";
  nama?: string;
}

export interface RegisterData {
  email: string;
  username: string;
  password: string;
}

export interface UpdateData {
  username?: string;
  email?: string;
}

export interface ApiResponse<T> {
  success: boolean;
  message: string;
  data: T;
}

export const akunService = {
  // Mendapatkan daftar semua muhafidz
  getAllMuhafiz: async (): Promise<ApiResponse<Muhafiz[]>> => {
    const response = await axiosClient.get<ApiResponse<Muhafiz[]>>("auth/muhafiz");
    return response.data;
  },

  // Mendaftarkan muhafiz baru
  registerMuhafiz: async (data: RegisterData): Promise<ApiResponse<{ user: Muhafiz }>> => {
    const response = await axiosClient.post<ApiResponse<{ user: Muhafiz }>>("/auth/register", data);
    return response.data;
  },

  // Edit data muhafiz
  updateMuhafiz: async (userId: number, data: UpdateData): Promise<ApiResponse<Muhafiz>> => {
    const response = await axiosClient.patch<ApiResponse<Muhafiz>>(`/auth/muhafiz/${userId}`, data);
    return response.data;
  },

  // Hapus akun muhafiz (soft delete)
  deleteMuhafiz: async (userId: number): Promise<ApiResponse<null>> => {
    const response = await axiosClient.delete<ApiResponse<null>>(`/auth/muhafiz/${userId}`);
    return response.data;
  }
};

--- FILE: ./services/halaqahService.ts ---

import axiosClient from "@/api/axiosClient";

export interface Halaqah {
  id_halaqah: number;
  nama_halaqah: string;
  jenis: "BACAAN" | "HAFALAN" | "KHUSUS";
  muhafidz_id: number;
  muhafidz: {
    id_user: number;
    username: string;
    email: string;
  };
  jumlah_santri?: number;
}

export interface CreateHalaqahData {
  nama_halaqah: string;
  jenis: "BACAAN" | "HAFALAN" | "KHUSUS";
  muhafidz_id: number;
}

export interface UpdateHalaqahData {
  nama_halaqah?: string;
  jenis?: "BACAAN" | "HAFALAN" | "KHUSUS";
  muhafidz_id?: number;
}

export interface ApiResponse<T> {
  success: boolean;
  message: string;
  data: T;
}

export const halaqahService = {
  // Mendapatkan semua halaqah
  getAllHalaqah: async (): Promise<ApiResponse<Halaqah[]>> => {
    const response = await axiosClient.get<ApiResponse<Halaqah[]>>("/halaqah");
    return response.data;
  },

  // Membuat halaqah baru
  createHalaqah: async (data: CreateHalaqahData): Promise<ApiResponse<Halaqah>> => {
    const response = await axiosClient.post<ApiResponse<Halaqah>>("/halaqah", data);
    return response.data;
  },

  // Mengupdate halaqah
  updateHalaqah: async (id: number, data: UpdateHalaqahData): Promise<ApiResponse<Halaqah>> => {
    const response = await axiosClient.patch<ApiResponse<Halaqah>>(`/halaqah/${id}`, data);
    return response.data;
  },

  // Menghapus halaqah
  deleteHalaqah: async (id: number): Promise<ApiResponse<null>> => {
    const response = await axiosClient.delete<ApiResponse<null>>(`/halaqah/${id}`);
    return response.data;
  },

  // Mendapatkan daftar muhafiz yang belum punya halaqah
  getAvailableMuhafiz: async (): Promise<ApiResponse<Array<{ id_user: number; username: string; email: string }>>> => {
    const response = await axiosClient.get<ApiResponse<Array<{ id_user: number; username: string; email: string }>>>("/halaqah/available-muhafiz");
    return response.data;
  }
};

--- FILE: ./App.css ---

/* @import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

#root {
  max-width: 1280px;
  margin: 0 auto;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
} */


--- FILE: ./App.tsx ---

import { BrowserRouter } from "react-router-dom";
import { AuthProvider } from "@/context/AuthContext";
import { AppRouter } from "@/routes";
import { Toaster } from "@/components/ui/sonner";
import "./App.css";

function App() {
  return (
    <BrowserRouter>
      <AuthProvider>
        <AppRouter />
        <Toaster position="top-center" richColors closeButton />
      </AuthProvider>
    </BrowserRouter>
  );
}

export default App;

--- FILE: ./src.txt ---

